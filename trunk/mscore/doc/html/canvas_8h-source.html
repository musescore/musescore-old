<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>MuseScore: canvas.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>canvas.h</h1><a href="canvas_8h.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">//=========================================================</span>
00002 <span class="comment">//  MusE Score</span>
00003 <span class="comment">//  Linux Music Score Editor</span>
00004 <span class="comment">//  $Id: canvas.h,v 1.21 2005/06/20 13:54:53 wschweer Exp $</span>
00005 <span class="comment">//</span>
00006 <span class="comment">//  (C) Copyright 2002-2004 Werner Schweer (ws@seh.de)</span>
00007 <span class="comment">//=========================================================</span>
00008 
00009 <span class="preprocessor">#ifndef __SCANVAS_H__</span>
00010 <span class="preprocessor"></span><span class="preprocessor">#define __SCANVAS_H__</span>
00011 <span class="preprocessor"></span>
00012 <span class="preprocessor">#include "<a class="code" href="page_8h.html">page.h</a>"</span>
00013 <span class="preprocessor">#include "<a class="code" href="viewer_8h.html">viewer.h</a>"</span>
00014 
00015 <span class="keyword">class </span><a class="code" href="classRest.html">Rest</a>;
00016 <span class="keyword">class </span><a class="code" href="classElement.html">Element</a>;
00017 <span class="keyword">class </span>Transformation;
00018 <span class="keyword">class </span><a class="code" href="classPage.html">Page</a>;
00019 <span class="keyword">class </span><a class="code" href="classPad.html">Pad</a>;
00020 <span class="keyword">class </span><a class="code" href="classXml.html">Xml</a>;
00021 <span class="keyword">class </span><a class="code" href="classNote.html">Note</a>;
00022 <span class="keyword">class </span><a class="code" href="classLasso.html">Lasso</a>;
00023 <span class="keyword">class </span><a class="code" href="classShadowNote.html">ShadowNote</a>;
00024 
00025 <span class="comment">//---------------------------------------------------------</span>
00026 <span class="comment">//   Canvas</span>
00027 <span class="comment">//---------------------------------------------------------</span>
00028 
<a name="l00029"></a><a class="code" href="classCanvas.html">00029</a> <span class="keyword">class </span><a class="code" href="classCanvas.html">Canvas</a> : <span class="keyword">public</span> QWidget, <span class="keyword">public</span> <a class="code" href="classViewer.html">Viewer</a> {
00030       Q_OBJECT
00031 
<a name="l00032"></a><a class="code" href="classCanvas.html#r0">00032</a>       <a class="code" href="classScore.html">Score</a>* <a class="code" href="classCanvas.html#r0">_score</a>;
00033 
00034    <span class="keyword">public</span>:
<a name="l00035"></a><a class="code" href="classCanvas.html#w9">00035</a>       <span class="keyword">enum</span> <a class="code" href="classCanvas.html#w9">State</a> { <a class="code" href="classCanvas.html#w9w0">NORMAL</a>, <a class="code" href="classCanvas.html#w9w1">DRAG_OBJ</a>, <a class="code" href="classCanvas.html#w9w2">DRAG_STAFF</a>, <a class="code" href="classCanvas.html#w9w3">PALETTE</a>,
00036          <a class="code" href="classCanvas.html#w9w4">EDIT</a>, <a class="code" href="classCanvas.html#w9w5">DRAG_EDIT</a>, <a class="code" href="classCanvas.html#w9w6">LASSO</a>, <a class="code" href="classCanvas.html#w9w7">NOTE_ENTRY</a>, <a class="code" href="classCanvas.html#w9w8">MAG</a> };
00037 
00038    <span class="keyword">private</span>:
<a name="l00039"></a><a class="code" href="classCanvas.html#r1">00039</a>       <span class="keywordtype">bool</span> <a class="code" href="classCanvas.html#r1">mouseClick</a>;
<a name="l00040"></a><a class="code" href="classCanvas.html#r2">00040</a>       <span class="keywordtype">int</span> <a class="code" href="classCanvas.html#r2">keyState</a>;
<a name="l00041"></a><a class="code" href="classCanvas.html#r3">00041</a>       <span class="keywordtype">int</span> <a class="code" href="classCanvas.html#r3">buttonState</a>;
<a name="l00042"></a><a class="code" href="classCanvas.html#r4">00042</a>       <a class="code" href="classCanvas.html#w9">State</a> <a class="code" href="classCanvas.html#r4">state</a>;
<a name="l00043"></a><a class="code" href="classCanvas.html#r5">00043</a>       <span class="keywordtype">bool</span> <a class="code" href="classCanvas.html#r5">dragCanvasState</a>;
00044 
<a name="l00045"></a><a class="code" href="classCanvas.html#r6">00045</a>       <span class="keywordtype">bool</span> <a class="code" href="classCanvas.html#r6">cursorIsBlinking</a>;
00046 
<a name="l00047"></a><a class="code" href="classCanvas.html#r7">00047</a>       QMatrix <a class="code" href="classCanvas.html#r7">matrix</a>, <a class="code" href="classCanvas.html#r8">imatrix</a>;
00048 
<a name="l00049"></a><a class="code" href="classCanvas.html#r9">00049</a>       QPointF <a class="code" href="classCanvas.html#r9">startMove</a>;
00050 
<a name="l00051"></a><a class="code" href="classCanvas.html#r10">00051</a>       <a class="code" href="classPad.html">Pad</a>* <a class="code" href="classCanvas.html#r10">pad</a>;
00052 
00053       <span class="comment">//--input state:</span>
<a name="l00054"></a><a class="code" href="classCanvas.html#r11">00054</a>       <a class="code" href="classCursor.html">Cursor</a>* <a class="code" href="classCanvas.html#r11">cursor</a>;
<a name="l00055"></a><a class="code" href="classCanvas.html#r12">00055</a>       <a class="code" href="classShadowNote.html">ShadowNote</a>* <a class="code" href="classCanvas.html#r12">shadowNote</a>;
<a name="l00056"></a><a class="code" href="classCanvas.html#r13">00056</a>       QTimer* <a class="code" href="classCanvas.html#r13">cursorTimer</a>;    <span class="comment">// blink timer</span>
00057 
<a name="l00058"></a><a class="code" href="classCanvas.html#r14">00058</a>       <a class="code" href="classElement.html">Element</a>* <a class="code" href="classCanvas.html#r14">propertyObject</a>;
<a name="l00059"></a><a class="code" href="classCanvas.html#r15">00059</a>       <span class="keywordtype">int</span> <a class="code" href="classCanvas.html#r15">propertyStaff</a>;
00060 
<a name="l00061"></a><a class="code" href="classCanvas.html#r16">00061</a>       <a class="code" href="classLasso.html">Lasso</a>* <a class="code" href="classCanvas.html#r16">lasso</a>;           <span class="comment">// temporarily drawn lasso selection</span>
00062 
<a name="l00063"></a><a class="code" href="classCanvas.html#r17">00063</a>       QColor <a class="code" href="classCanvas.html#r17">_bgColor</a>;
<a name="l00064"></a><a class="code" href="classCanvas.html#r18">00064</a>       QColor <a class="code" href="classCanvas.html#r18">_fgColor</a>;
<a name="l00065"></a><a class="code" href="classCanvas.html#r19">00065</a>       QPixmap* <a class="code" href="classCanvas.html#r19">bgPixmap</a>;
<a name="l00066"></a><a class="code" href="classCanvas.html#r20">00066</a>       QPixmap* <a class="code" href="classCanvas.html#r20">fgPixmap</a>;
00067 
00068       <span class="comment">//============================================</span>
00069 
00070       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#d0">redraw</a>(<span class="keyword">const</span> QRectF&amp; r);
<a name="l00071"></a><a class="code" href="classCanvas.html#d1">00071</a>       <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#d1">updateAll</a>(<a class="code" href="classScore.html">Score</a>*) { update(); }
00072 
00073       <span class="keywordtype">void</span> canvasPopup(<span class="keyword">const</span> QPoint&amp;);
00074       <span class="keywordtype">void</span> objectPopup(<span class="keyword">const</span> QPoint&amp;, <a class="code" href="classElement.html">Element</a>*);
00075 
00076       <span class="keywordtype">void</span> saveChord(<a class="code" href="classXml.html">Xml</a>&amp;);
00077       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#d5">incMag</a>();
00078       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#d6">decMag</a>();
00079 
00080       <span class="keyword">virtual</span> <span class="keywordtype">void</span> mousePressEvent(QMouseEvent*);
00081       <span class="keyword">virtual</span> <span class="keywordtype">void</span> mouseMoveEvent(QMouseEvent*);
00082       <span class="keywordtype">void</span> mouseMoveEvent1(QMouseEvent*);
00083       <span class="keyword">virtual</span> <span class="keywordtype">void</span> mouseReleaseEvent(QMouseEvent*);
00084       <span class="keywordtype">void</span> mouseReleaseEvent1(QMouseEvent*);
00085       <span class="keyword">virtual</span> <span class="keywordtype">void</span> mouseDoubleClickEvent(QMouseEvent*);
00086       <span class="keyword">virtual</span> <span class="keywordtype">bool</span> event(QEvent*);
00087       <span class="keyword">virtual</span> <span class="keywordtype">void</span> focusInEvent(QFocusEvent*);
00088       <span class="keyword">virtual</span> <span class="keywordtype">void</span> focusOutEvent(QFocusEvent*);
00089 
00090       <span class="keywordtype">void</span> contextItem(<a class="code" href="classElement.html">Element</a>*);
00091 
00092       QRegion <a class="code" href="classCanvas.html#d17">lassoSelect</a>();
00093       <a class="code" href="classNote.html">Note</a>* searchTieNote(<a class="code" href="classNote.html">Note</a>* note);
00094 
00095       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#d19">endEdit</a>();
00096       <span class="keywordtype">void</span> setShadowNote(<span class="keyword">const</span> QPointF&amp;);
00097 
00098    <span class="keyword">private</span> slots:
00099       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#k0">cursorBlink</a>();
00100 
00101    <span class="keyword">public</span> slots:
00102       <span class="keyword">virtual</span> <span class="keywordtype">void</span> keyPressEvent(QKeyEvent*);
00103       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#i1">showPad</a>();
00104       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#i2">cmdCut</a>();
00105       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#i3">cmdCopy</a>();
00106       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#i4">cmdPaste</a>();
00107       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#i5">magCanvas</a>();
00108 
00109       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#i6">resetStaffOffsets</a>();
00110       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#i7">showInvisibleClicked</a>();
00111 
00112    signals:
00113       <span class="keywordtype">void</span> padVisible(<span class="keywordtype">bool</span>);
00114       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#l1">showInvisibleChanged</a>();
00115       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#l2">magChanged</a>();
00116 
00117    <span class="keyword">public</span>:
00118       <a class="code" href="classCanvas.html">Canvas</a>(QWidget* parent = 0);
00119       <a class="code" href="classCanvas.html#a1">~Canvas</a>();
00120 
00121       <span class="keyword">virtual</span> <span class="keywordtype">void</span> paintEvent(QPaintEvent*);
00122 
00123       <span class="keywordtype">void</span> setBackground(QPixmap*);
00124       <span class="keywordtype">void</span> setBackground(<span class="keyword">const</span> QColor&amp;);
00125       <span class="keywordtype">void</span> setForeground(QPixmap*);
00126       <span class="keywordtype">void</span> setForeground(<span class="keyword">const</span> QColor&amp;);
00127       <span class="keywordtype">void</span> setChanged(<span class="keywordtype">double</span> mag);
00128 
00129       <a class="code" href="classPage.html">Page</a>* <a class="code" href="classCanvas.html#a8">addPage</a>();
00130 
00131       <span class="keywordtype">void</span> modifyElement(<a class="code" href="classElement.html">Element</a>* obj);
00132 
00133       <span class="keyword">virtual</span> QRectF <a class="code" href="classCanvas.html#a10">moveCursor</a>();
00134       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#a11">clearScore</a>();
00135 
00136       <span class="keyword">virtual</span> <span class="keywordtype">void</span> dataChanged(<a class="code" href="classScore.html">Score</a>* cp, <span class="keyword">const</span> QRectF&amp;);
00137       <span class="keywordtype">void</span> setState(State);
<a name="l00138"></a><a class="code" href="classCanvas.html#a14">00138</a>       <a class="code" href="classCanvas.html#w9">State</a> <a class="code" href="classCanvas.html#a14">getState</a>()<span class="keyword"> const </span>{ <span class="keywordflow">return</span> <a class="code" href="classCanvas.html#r4">state</a>; }
00139       <span class="keywordtype">bool</span> startEdit(<a class="code" href="classElement.html">Element</a>*);
00140       <span class="keywordtype">void</span> setPadNo(<span class="keywordtype">int</span> padno);
<a name="l00141"></a><a class="code" href="classCanvas.html#a17">00141</a>       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#a17">setScore</a>(<a class="code" href="classScore.html">Score</a>* s) { <a class="code" href="classCanvas.html#r0">_score</a> = s; }
<a name="l00142"></a><a class="code" href="classCanvas.html#a18">00142</a>       <a class="code" href="classScore.html">Score</a>* <a class="code" href="classCanvas.html#a18">score</a>()<span class="keyword"> const    </span>{ <span class="keywordflow">return</span> <a class="code" href="classCanvas.html#r0">_score</a>; }
00143 
00144       qreal <a class="code" href="classCanvas.html#a19">mag</a>() const;
<a name="l00145"></a><a class="code" href="classCanvas.html#a20">00145</a>       qreal xoffset()<span class="keyword"> const   </span>{ <span class="keywordflow">return</span> <a class="code" href="classCanvas.html#r7">matrix</a>.dx();  }
<a name="l00146"></a><a class="code" href="classCanvas.html#a21">00146</a>       qreal <a class="code" href="classCanvas.html#a21">yoffset</a>()<span class="keyword"> const   </span>{ <span class="keywordflow">return</span> <a class="code" href="classCanvas.html#r7">matrix</a>.dy();  }
00147       <span class="keywordtype">void</span> setMag(qreal m);
<a name="l00148"></a><a class="code" href="classCanvas.html#a23">00148</a>       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#a23">setXoffset</a>(qreal x)  {
00149             <a class="code" href="classCanvas.html#r7">matrix</a>.setMatrix(<a class="code" href="classCanvas.html#r7">matrix</a>.m11(), <a class="code" href="classCanvas.html#r7">matrix</a>.m12(), <a class="code" href="classCanvas.html#r7">matrix</a>.m21(),
00150                <a class="code" href="classCanvas.html#r7">matrix</a>.m22(), x, <a class="code" href="classCanvas.html#r7">matrix</a>.dy());
00151             <a class="code" href="classCanvas.html#r8">imatrix</a> = <a class="code" href="classCanvas.html#r7">matrix</a>.inverted();
00152             }
<a name="l00153"></a><a class="code" href="classCanvas.html#a24">00153</a>       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#a24">setYoffset</a>(qreal y)  {
00154             <a class="code" href="classCanvas.html#r7">matrix</a>.setMatrix(<a class="code" href="classCanvas.html#r7">matrix</a>.m11(), <a class="code" href="classCanvas.html#r7">matrix</a>.m12(), <a class="code" href="classCanvas.html#r7">matrix</a>.m21(),
00155                <a class="code" href="classCanvas.html#r7">matrix</a>.m22(), <a class="code" href="classCanvas.html#r7">matrix</a>.dx(), y);
00156             <a class="code" href="classCanvas.html#r8">imatrix</a> = <a class="code" href="classCanvas.html#r7">matrix</a>.inverted();
00157             }
<a name="l00158"></a><a class="code" href="classCanvas.html#a25">00158</a>       <span class="keywordtype">void</span> <a class="code" href="classCanvas.html#a25">setOffset</a>(qreal x, qreal y) {
00159             <a class="code" href="classCanvas.html#r7">matrix</a>.setMatrix(<a class="code" href="classCanvas.html#r7">matrix</a>.m11(), <a class="code" href="classCanvas.html#r7">matrix</a>.m12(), <a class="code" href="classCanvas.html#r7">matrix</a>.m21(),
00160                <a class="code" href="classCanvas.html#r7">matrix</a>.m22(), x, y);
00161             <a class="code" href="classCanvas.html#r8">imatrix</a> = <a class="code" href="classCanvas.html#r7">matrix</a>.inverted();
00162             }
00163       QSizeF <a class="code" href="classCanvas.html#a26">fsize</a>() const;
00164       };
00165 
00166 extern <span class="keywordtype">int</span> searchStaff(const <a class="code" href="classElement.html">Element</a>* element);
00167 
00168 #endif
00169 
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Mon Jun 27 22:28:28 2005 for MuseScore by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
