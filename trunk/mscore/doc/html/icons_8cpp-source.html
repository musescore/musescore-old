<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>MuseScore: icons.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>icons.cpp</h1><a href="icons_8cpp.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">//=========================================================</span>
00002 <span class="comment">//  MuseScore</span>
00003 <span class="comment">//  Linux Music Score Editor</span>
00004 <span class="comment">//  $Id: icons.cpp,v 1.9 2005/06/27 19:50:19 wschweer Exp $</span>
00005 <span class="comment">//</span>
00006 <span class="comment">//  (C) Copyright 2002-2004 Werner Schweer (ws@seh.de)</span>
00007 <span class="comment">//=========================================================</span>
00008 
00009 <span class="preprocessor">#include "<a class="code" href="icons_8h.html">icons.h</a>"</span>
00010 <span class="preprocessor">#include "<a class="code" href="project_8h.html">project.h</a>"</span>
00011 <span class="preprocessor">#include "<a class="code" href="painter_8h.html">painter.h</a>"</span>
00012 <span class="preprocessor">#include "<a class="code" href="style_8h.html">style.h</a>"</span>
00013 
<a name="l00014"></a><a class="code" href="icons_8cpp.html#a0">00014</a> QIcon <a class="code" href="icons_8cpp.html#a0">noteIcon</a>;
<a name="l00015"></a><a class="code" href="icons_8cpp.html#a1">00015</a> QIcon <a class="code" href="icons_8cpp.html#a1">note2Icon</a>;
<a name="l00016"></a><a class="code" href="icons_8cpp.html#a2">00016</a> QIcon <a class="code" href="icons_8cpp.html#a2">note4Icon</a>;
<a name="l00017"></a><a class="code" href="icons_8cpp.html#a3">00017</a> QIcon <a class="code" href="icons_8cpp.html#a3">note8Icon</a>;
<a name="l00018"></a><a class="code" href="icons_8cpp.html#a4">00018</a> QIcon <a class="code" href="icons_8cpp.html#a4">note16Icon</a>;
<a name="l00019"></a><a class="code" href="icons_8cpp.html#a5">00019</a> QIcon <a class="code" href="icons_8cpp.html#a5">note32Icon</a>;
<a name="l00020"></a><a class="code" href="icons_8cpp.html#a6">00020</a> QIcon <a class="code" href="icons_8cpp.html#a6">note64Icon</a>;
00021 
<a name="l00022"></a><a class="code" href="icons_8cpp.html#a7">00022</a> QIcon <a class="code" href="icons_8cpp.html#a7">naturalIcon</a>;
<a name="l00023"></a><a class="code" href="icons_8cpp.html#a8">00023</a> QIcon <a class="code" href="icons_8cpp.html#a8">sharpIcon</a>;
<a name="l00024"></a><a class="code" href="icons_8cpp.html#a9">00024</a> QIcon <a class="code" href="icons_8cpp.html#a9">sharpsharpIcon</a>;
<a name="l00025"></a><a class="code" href="icons_8cpp.html#a10">00025</a> QIcon <a class="code" href="icons_8cpp.html#a10">flatIcon</a>;
<a name="l00026"></a><a class="code" href="icons_8cpp.html#a11">00026</a> QIcon <a class="code" href="icons_8cpp.html#a11">flatflatIcon</a>;
<a name="l00027"></a><a class="code" href="icons_8cpp.html#a12">00027</a> QIcon <a class="code" href="icons_8cpp.html#a12">quartrestIcon</a>;
<a name="l00028"></a><a class="code" href="icons_8cpp.html#a13">00028</a> QIcon <a class="code" href="icons_8cpp.html#a13">dotIcon</a>;
<a name="l00029"></a><a class="code" href="icons_8cpp.html#a14">00029</a> QIcon <a class="code" href="icons_8cpp.html#a14">sforzatoaccentIcon</a>;
<a name="l00030"></a><a class="code" href="icons_8cpp.html#a15">00030</a> QIcon <a class="code" href="icons_8cpp.html#a15">staccatoIcon</a>;
<a name="l00031"></a><a class="code" href="icons_8cpp.html#a16">00031</a> QIcon <a class="code" href="icons_8cpp.html#a16">tenutoIcon</a>;
00032 
00033 <span class="comment">//---------------------------------------------------------</span>
00034 <span class="comment">//   notePixmap</span>
00035 <span class="comment">//---------------------------------------------------------</span>
00036 
<a name="l00037"></a><a class="code" href="icons_8cpp.html#a17">00037</a> <span class="keyword">static</span> QPixmap <a class="code" href="icons_8cpp.html#a17">notePixmap</a>(<span class="keywordtype">int</span> ticks, <span class="keyword">const</span> QColor&amp; fg, <span class="keywordtype">int</span> height)
00038       {
00039       <a class="code" href="structTextStyle.html">TextStyle</a>* s = &amp;<a class="code" href="style_8cpp.html#a3">textStyles</a>[<a class="code" href="style_8h.html#a45a19">TEXT_STYLE_SYMBOL1</a>];
00040       QFont f(s-&gt;<a class="code" href="structTextStyle.html#o1">family</a>, 12);
00041 
00042       <span class="keywordtype">int</span> width = height;
00043       QPixmap pm(width, height);
00044 
00045       <a class="code" href="classPainter.html">Painter</a> painter(&amp;pm);
00046       painter.setFont(f);
00047 
00048       pm.fill(Qt::white);
00049 
00050       QPen pen(fg);
00051       pen.setWidthF(1.0);
00052       painter.setPen(pen);
00053 
00054       QChar code;
00055       <span class="keywordflow">switch</span>(ticks) {
00056             <span class="keywordflow">case</span> <a class="code" href="mtime_8h.html#a0">division</a>*4:
00057                   code = 0xe11b;
00058                   <span class="keywordflow">break</span>;
00059             <span class="keywordflow">case</span> <a class="code" href="mtime_8h.html#a0">division</a>*2:
00060                   code = 0xe11c;
00061                   <span class="keywordflow">break</span>;
00062             <span class="keywordflow">default</span>:
00063                   code = 0xe11d;
00064                   <span class="keywordflow">break</span>;
00065             }
00066       QFontMetricsF fm(f);
00067       QRectF bb(fm.boundingRect(code));
00068 
00069       qreal w   = bb.width();
00070       qreal h   = bb.height();
00071       qreal x   = 2;
00072       qreal y   = height - h - bb.y() - 1;
00073 
00074       painter.drawText(QPointF(x, y), QString(code));
00075 
00076       <span class="keywordflow">if</span> (ticks &lt; <a class="code" href="mtime_8h.html#a0">division</a>*4) {
00077             x += w;
00078             QPointF p(x+.5, 0.0);
00079             painter.drawLine(QLineF(x, y, x, 0));
00080             y = 0;
00081             <span class="keywordflow">switch</span> (ticks) {
00082                   <span class="keywordflow">case</span> <a class="code" href="mtime_8h.html#a0">division</a>/16:
00083                         painter.drawText(p, QString(0xe182));
00084                         <span class="keywordflow">break</span>;
00085                   <span class="keywordflow">case</span> <a class="code" href="mtime_8h.html#a0">division</a>/8:
00086                         painter.drawText(p, QString(0xe181));
00087                         <span class="keywordflow">break</span>;
00088                   <span class="keywordflow">case</span> <a class="code" href="mtime_8h.html#a0">division</a>/4:
00089                         painter.drawText(p, QString(0xe180));
00090                         <span class="keywordflow">break</span>;
00091                   <span class="keywordflow">case</span> <a class="code" href="mtime_8h.html#a0">division</a>/2:
00092                         painter.drawText(p, QString(0xe17f));
00093                         <span class="keywordflow">break</span>;
00094                   }
00095             }
00096       painter.end();
00097       pm.setMask(pm.createHeuristicMask());
00098       <span class="keywordflow">return</span> pm;
00099       }
00100 
00101 <span class="comment">//---------------------------------------------------------</span>
00102 <span class="comment">//   noteIconSet</span>
00103 <span class="comment">//---------------------------------------------------------</span>
00104 
<a name="l00105"></a><a class="code" href="icons_8cpp.html#a18">00105</a> <span class="keyword">static</span> QIcon <a class="code" href="icons_8cpp.html#a18">noteIconSet</a>(<span class="keywordtype">int</span> ticks)
00106       {
00107       <span class="keywordflow">return</span> QIcon(<a class="code" href="icons_8cpp.html#a17">notePixmap</a>(ticks, Qt::black, ICON_SIZE));
00108       }
00109 
00110 <span class="comment">//---------------------------------------------------------</span>
00111 <span class="comment">//   symPixmap</span>
00112 <span class="comment">//---------------------------------------------------------</span>
00113 
<a name="l00114"></a><a class="code" href="icons_8cpp.html#a19">00114</a> <span class="keyword">static</span> QPixmap <a class="code" href="icons_8cpp.html#a19">symPixmap</a>(<span class="keyword">const</span> <a class="code" href="structSym.html">Sym</a>&amp; sym, <span class="keywordtype">int</span> size)
00115       {
00116       <a class="code" href="structTextStyle.html">TextStyle</a>* s = &amp;<a class="code" href="style_8cpp.html#a3">textStyles</a>[<a class="code" href="style_8h.html#a45a19">TEXT_STYLE_SYMBOL1</a>];
00117       QFont f(s-&gt;<a class="code" href="structTextStyle.html#o1">family</a>, 14);
00118 
00119       <span class="keywordtype">int</span> width = size;
00120       QPixmap pm(width, size);
00121       <a class="code" href="classPainter.html">Painter</a> painter(&amp;pm);
00122       painter.setFont(f);
00123 
00124       pm.fill(Qt::white);
00125 
00126       QFontMetricsF fm(f);
00127       QRectF bb(fm.boundingRect(sym.<a class="code" href="structSym.html#a10">code</a>()));
00128       qreal x = (width - bb.width()) / 2.0;
00129       qreal y = (size  - bb.height()) / 2.0;
00130 
00131       painter.drawText(QPointF(x - bb.x(), y - bb.y()), QString(sym.<a class="code" href="structSym.html#a10">code</a>()));
00132 
00133       painter.end();
00134       pm.setMask(pm.createMaskFromColor(Qt::white));
00135       <span class="keywordflow">return</span> pm;
00136       }
00137 
00138 <span class="comment">//---------------------------------------------------------</span>
00139 <span class="comment">//   symIcon</span>
00140 <span class="comment">//---------------------------------------------------------</span>
00141 
<a name="l00142"></a><a class="code" href="icons_8cpp.html#a20">00142</a> <span class="keyword">static</span> QIcon <a class="code" href="icons_8cpp.html#a20">symIcon</a>(<span class="keyword">const</span> <a class="code" href="structSym.html">Sym</a>&amp; sym)
00143       {
00144       <span class="keywordflow">return</span> QIcon(<a class="code" href="icons_8cpp.html#a19">symPixmap</a>(sym, ICON_SIZE));
00145       }
00146 
00147 <span class="comment">//---------------------------------------------------------</span>
00148 <span class="comment">//   genIcons</span>
00149 <span class="comment">//    create some icon sets</span>
00150 <span class="comment">//---------------------------------------------------------</span>
00151 
<a name="l00152"></a><a class="code" href="icons_8h.html#a18">00152</a> <span class="keywordtype">void</span> <a class="code" href="icons_8cpp.html#a21">genIcons</a>()
00153       {
00154       <a class="code" href="icons_8cpp.html#a0">noteIcon</a>           = <a class="code" href="icons_8cpp.html#a18">noteIconSet</a>(<a class="code" href="mtime_8h.html#a0">division</a> * 4);
00155       <a class="code" href="icons_8cpp.html#a1">note2Icon</a>          = <a class="code" href="icons_8cpp.html#a18">noteIconSet</a>(<a class="code" href="mtime_8h.html#a0">division</a> * 2);
00156       <a class="code" href="icons_8cpp.html#a2">note4Icon</a>          = <a class="code" href="icons_8cpp.html#a18">noteIconSet</a>(<a class="code" href="mtime_8h.html#a0">division</a>);
00157       <a class="code" href="icons_8cpp.html#a3">note8Icon</a>          = <a class="code" href="icons_8cpp.html#a18">noteIconSet</a>(<a class="code" href="mtime_8h.html#a0">division</a>/2);
00158       <a class="code" href="icons_8cpp.html#a4">note16Icon</a>         = <a class="code" href="icons_8cpp.html#a18">noteIconSet</a>(<a class="code" href="mtime_8h.html#a0">division</a>/4);
00159       <a class="code" href="icons_8cpp.html#a5">note32Icon</a>         = <a class="code" href="icons_8cpp.html#a18">noteIconSet</a>(<a class="code" href="mtime_8h.html#a0">division</a>/8);
00160       <a class="code" href="icons_8cpp.html#a6">note64Icon</a>         = <a class="code" href="icons_8cpp.html#a18">noteIconSet</a>(<a class="code" href="mtime_8h.html#a0">division</a>/16);
00161 
00162       <a class="code" href="icons_8cpp.html#a7">naturalIcon</a>        = <a class="code" href="icons_8cpp.html#a20">symIcon</a>(<a class="code" href="symbols_8cpp.html#a25">naturalSym</a>);
00163       <a class="code" href="icons_8cpp.html#a8">sharpIcon</a>          = <a class="code" href="icons_8cpp.html#a20">symIcon</a>(<a class="code" href="symbols_8cpp.html#a24">sharpSym</a>);
00164       <a class="code" href="icons_8cpp.html#a9">sharpsharpIcon</a>     = <a class="code" href="icons_8cpp.html#a20">symIcon</a>(<a class="code" href="symbols_8cpp.html#a28">sharpsharpSym</a>);
00165       <a class="code" href="icons_8cpp.html#a10">flatIcon</a>           = <a class="code" href="icons_8cpp.html#a20">symIcon</a>(<a class="code" href="symbols_8cpp.html#a26">flatSym</a>);
00166       <a class="code" href="icons_8cpp.html#a11">flatflatIcon</a>       = <a class="code" href="icons_8cpp.html#a20">symIcon</a>(<a class="code" href="symbols_8cpp.html#a27">flatflatSym</a>);
00167       <a class="code" href="icons_8cpp.html#a12">quartrestIcon</a>      = <a class="code" href="icons_8cpp.html#a20">symIcon</a>(<a class="code" href="symbols_8cpp.html#a7">quartrestSym</a>);
00168       <a class="code" href="icons_8cpp.html#a13">dotIcon</a>            = <a class="code" href="icons_8cpp.html#a20">symIcon</a>(<a class="code" href="symbols_8cpp.html#a31">dotSym</a>);
00169       <a class="code" href="icons_8cpp.html#a14">sforzatoaccentIcon</a> = <a class="code" href="icons_8cpp.html#a20">symIcon</a>(<a class="code" href="symbols_8cpp.html#a53">sforzatoaccentSym</a>);
00170       <a class="code" href="icons_8cpp.html#a15">staccatoIcon</a>       = <a class="code" href="icons_8cpp.html#a20">symIcon</a>(<a class="code" href="symbols_8cpp.html#a54">staccatoSym</a>);
00171       <a class="code" href="icons_8cpp.html#a16">tenutoIcon</a>         = <a class="code" href="icons_8cpp.html#a20">symIcon</a>(<a class="code" href="symbols_8cpp.html#a57">tenutoSym</a>);
00172       }
00173 
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Mon Jun 27 22:28:28 2005 for MuseScore by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
