<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>MuseScore: clef.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>clef.cpp</h1><a href="clef_8cpp.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">//=========================================================</span>
00002 <span class="comment">//  MuseScore</span>
00003 <span class="comment">//  Linux Music Score Editor</span>
00004 <span class="comment">//  $Id: clef.cpp,v 1.5 2005/04/08 19:37:04 wschweer Exp $</span>
00005 <span class="comment">//</span>
00006 <span class="comment">//  (C) Copyright 2002-2004 Werner Schweer (ws@seh.de)</span>
00007 <span class="comment">//=========================================================</span>
00008 
00009 <span class="preprocessor">#include "<a class="code" href="clef_8h.html">clef.h</a>"</span>
00010 <span class="preprocessor">#include "<a class="code" href="xml_8h.html">xml.h</a>"</span>
00011 <span class="preprocessor">#include "<a class="code" href="utils_8h.html">utils.h</a>"</span>
00012 
00013 <span class="comment">//---------------------------------------------------------</span>
00014 <span class="comment">//   clef</span>
00015 <span class="comment">//---------------------------------------------------------</span>
00016 
<a name="l00017"></a><a class="code" href="classClefList.html#a1">00017</a> <span class="keywordtype">int</span> <a class="code" href="classClefList.html#a1">ClefList::clef</a>(<span class="keywordtype">int</span> tick)<span class="keyword"> const</span>
00018 <span class="keyword">      </span>{
00019       <span class="keywordflow">if</span> (empty())
00020             <span class="keywordflow">return</span> 0;
00021       <a class="code" href="clef_8h.html#a2">ciClefEvent</a> i = upper_bound(tick);
00022       <span class="keywordflow">if</span> (i == begin())
00023             <span class="keywordflow">return</span> 0;
00024       --i;
00025       <span class="keywordflow">return</span> i-&gt;second;
00026       }
00027 
00028 <span class="comment">//---------------------------------------------------------</span>
00029 <span class="comment">//   setClef</span>
00030 <span class="comment">//---------------------------------------------------------</span>
00031 
<a name="l00032"></a><a class="code" href="classClefList.html#a2">00032</a> <span class="keywordtype">void</span> <a class="code" href="classClefList.html#a2">ClefList::setClef</a>(<span class="keywordtype">int</span> tick, <span class="keywordtype">int</span> idx)
00033       {
00034       std::pair&lt;int, int&gt; <a class="code" href="classClefList.html#a1">clef</a>(tick, idx);
00035       std::pair&lt;iClefEvent,bool&gt; p = insert(clef);
00036       <span class="keywordflow">if</span> (!p.second)
00037             (*this)[tick] = idx;
00038       <a class="code" href="clef_8h.html#a1">iClefEvent</a> i = p.first;
00039       <span class="keywordflow">for</span> (++i; i != end();) {
00040             <span class="keywordflow">if</span> (i-&gt;second != idx)
00041                   <span class="keywordflow">break</span>;
00042             <a class="code" href="clef_8h.html#a1">iClefEvent</a> ii = i;
00043             ++ii;
00044             erase(i);
00045             i = ii;
00046             }
00047       }
00048 
00049 <span class="comment">//---------------------------------------------------------</span>
00050 <span class="comment">//   ClefList::write</span>
00051 <span class="comment">//---------------------------------------------------------</span>
00052 
<a name="l00053"></a><a class="code" href="classClefList.html#a5">00053</a> <span class="keywordtype">void</span> <a class="code" href="classClefList.html#a5">ClefList::write</a>(<a class="code" href="classXml.html">Xml</a>&amp; xml, <span class="keyword">const</span> <span class="keywordtype">char</span>* name)<span class="keyword"> const</span>
00054 <span class="keyword">      </span>{
00055       xml.<a class="code" href="classXml.html#a8">tag</a>(name);
00056       <span class="keywordflow">for</span> (<a class="code" href="clef_8h.html#a2">ciClefEvent</a> i = begin(); i != end(); ++i)
00057             xml.<a class="code" href="classXml.html#a6">put</a>(<span class="stringliteral">"&lt;clef tick=\"%d\" idx=\"%d\"/&gt;"</span>, i-&gt;first, i-&gt;second);
00058       xml.<a class="code" href="classXml.html#a9">etag</a>(name);
00059       }
00060 
00061 <span class="comment">//---------------------------------------------------------</span>
00062 <span class="comment">//   ClefList::read</span>
00063 <span class="comment">//---------------------------------------------------------</span>
00064 
<a name="l00065"></a><a class="code" href="classClefList.html#a3">00065</a> <span class="keywordtype">void</span> <a class="code" href="classClefList.html#a3">ClefList::read</a>(QDomNode node)
00066       {
00067       node = node.firstChild();
00068       <span class="keywordflow">while</span> (!node.isNull()) {
00069             QDomElement e = node.toElement();
00070             QString tag(e.tagName());
00071 
00072             <span class="keywordflow">if</span> (tag == <span class="stringliteral">"clef"</span>)
00073                   <a class="code" href="classClefList.html#a4">readEvent</a>(node);
00074             <span class="keywordflow">else</span>
00075                   <a class="code" href="utils_8h.html#a4">domError</a>(node);
00076             node = node.nextSibling();
00077             }
00078       }
00079 
00080 <span class="comment">//---------------------------------------------------------</span>
00081 <span class="comment">//   ClefEvent::read</span>
00082 <span class="comment">//---------------------------------------------------------</span>
00083 
<a name="l00084"></a><a class="code" href="classClefList.html#a4">00084</a> <span class="keywordtype">void</span> <a class="code" href="classClefList.html#a4">ClefList::readEvent</a>(QDomNode node)
00085       {
00086       QDomElement e = node.toElement();
00087       <span class="keywordtype">int</span> tick = e.attribute(<span class="stringliteral">"tick"</span>, <span class="stringliteral">"0"</span>).toInt();
00088       <span class="keywordtype">int</span> idx = e.attribute(<span class="stringliteral">"idx"</span>, <span class="stringliteral">"0"</span>).toInt();
00089       (*this)[tick] = idx;
00090       }
00091 
00092 <span class="comment">//---------------------------------------------------------</span>
00093 <span class="comment">//   removeTime</span>
00094 <span class="comment">//---------------------------------------------------------</span>
00095 
<a name="l00096"></a><a class="code" href="classClefList.html#a6">00096</a> <span class="keywordtype">void</span> <a class="code" href="classClefList.html#a6">ClefList::removeTime</a>(<span class="keywordtype">int</span> s, <span class="keywordtype">int</span> e)
00097       {
00098       erase(find(s), find(e));
00099       }
00100 
00101 <span class="comment">//---------------------------------------------------------</span>
00102 <span class="comment">//   insertTime</span>
00103 <span class="comment">//---------------------------------------------------------</span>
00104 
<a name="l00105"></a><a class="code" href="classClefList.html#a7">00105</a> <span class="keywordtype">void</span> <a class="code" href="classClefList.html#a7">ClefList::insertTime</a>(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>)
00106       {
00107       printf(<span class="stringliteral">"ClefList::insertTime(): not impl.\n"</span>);
00108       }
00109 
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Mon Jun 27 22:28:28 2005 for MuseScore by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
