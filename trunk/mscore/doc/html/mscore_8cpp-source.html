<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>MuseScore: mscore.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>mscore.cpp</h1><a href="mscore_8cpp.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">//=========================================================</span>
00002 <span class="comment">//  MuseScore</span>
00003 <span class="comment">//  Linux Music Score Editor</span>
00004 <span class="comment">//  $Id: mscore.cpp,v 1.57 2005/06/27 19:50:21 wschweer Exp $</span>
00005 <span class="comment">//</span>
00006 <span class="comment">//  (C) Copyright 2002-2004 Werner Schweer (ws@seh.de)</span>
00007 <span class="comment">//=========================================================</span>
00008 
00009 <span class="preprocessor">#include &lt;signal.h&gt;</span>
00010 <span class="preprocessor">#include &lt;fenv.h&gt;</span>
00011 <span class="preprocessor">#include &lt;QX11Info&gt;</span>
00012 
00013 <span class="preprocessor">#include "<a class="code" href="mscore_8h.html">mscore.h</a>"</span>
00014 <span class="preprocessor">#include "<a class="code" href="canvas_8h.html">canvas.h</a>"</span>
00015 <span class="preprocessor">#include "<a class="code" href="style_8h.html">style.h</a>"</span>
00016 <span class="preprocessor">#include "<a class="code" href="buttons_8h.html">buttons.h</a>"</span>
00017 <span class="preprocessor">#include "<a class="code" href="project_8h.html">project.h</a>"</span>
00018 <span class="preprocessor">#include "<a class="code" href="instrdialog_8h.html">instrdialog.h</a>"</span>
00019 <span class="preprocessor">#include "<a class="code" href="preferences_8h.html">preferences.h</a>"</span>
00020 <span class="preprocessor">#include "<a class="code" href="config_8h.html">config.h</a>"</span>
00021 <span class="preprocessor">#include "<a class="code" href="icons_8h.html">icons.h</a>"</span>
00022 <span class="preprocessor">#include "<a class="code" href="textstyle_8h.html">textstyle.h</a>"</span>
00023 <span class="preprocessor">#include "<a class="code" href="xml_8h.html">xml.h</a>"</span>
00024 <span class="preprocessor">#include "<a class="code" href="seq_8h.html">seq.h</a>"</span>
00025 <span class="preprocessor">#include "<a class="code" href="app_8h.html">app.h</a>"</span>
00026 <span class="preprocessor">#include "<a class="code" href="icons_8h.html">icons.h</a>"</span>
00027 
00028 <span class="preprocessor">#include "xpm/fileprint.xpm"</span>
00029 <span class="preprocessor">#include "xpm/filenew.xpm"</span>
00030 <span class="preprocessor">#include "xpm/fileopen.xpm"</span>
00031 <span class="preprocessor">#include "xpm/filesave.xpm"</span>
00032 <span class="preprocessor">#include "xpm/undo.xpm"</span>
00033 <span class="preprocessor">#include "xpm/redo.xpm"</span>
00034 <span class="preprocessor">#include "xpm/editcut.xpm"</span>
00035 <span class="preprocessor">#include "xpm/editcopy.xpm"</span>
00036 <span class="preprocessor">#include "xpm/editpaste.xpm"</span>
00037 <span class="preprocessor">#include "xpm/undoS.xpm"</span>
00038 <span class="preprocessor">#include "xpm/redoS.xpm"</span>
00039 <span class="preprocessor">#include "xpm/editcutS.xpm"</span>
00040 <span class="preprocessor">#include "xpm/editcopyS.xpm"</span>
00041 <span class="preprocessor">#include "xpm/editpasteS.xpm"</span>
00042 <span class="preprocessor">#include "xpm/exitS.xpm"</span>
00043 <span class="preprocessor">#include "xpm/viewmag.xpm"</span>
00044 <span class="preprocessor">#include "xpm/viewmagS.xpm"</span>
00045 <span class="preprocessor">#include "xpm/flip.xpm"</span>
00046 <span class="preprocessor">#include "xpm/start.xpm"</span>
00047 <span class="preprocessor">#include "xpm/stop.xpm"</span>
00048 <span class="preprocessor">#include "xpm/play.xpm"</span>
00049 
00050 <span class="preprocessor">#include "<a class="code" href="padids_8h.html">padids.h</a>"</span>
00051 <span class="preprocessor">#include "<a class="code" href="alsa_8h.html">alsa.h</a>"</span>
00052 <span class="preprocessor">#include "<a class="code" href="pagesettings_8h.html">pagesettings.h</a>"</span>
00053 
<a name="l00054"></a><a class="code" href="mscore_8cpp.html#a0">00054</a> QString <a class="code" href="mscore_8cpp.html#a0">mscoreGlobalShare</a>;
00055 
<a name="l00056"></a><a class="code" href="mscore_8cpp.html#a1">00056</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="mscore_8cpp.html#a1">magTable</a>[] = {
00057      <span class="stringliteral">"25%"</span>, <span class="stringliteral">"50%"</span>, <span class="stringliteral">"75%"</span>, <span class="stringliteral">"100%"</span>, <span class="stringliteral">"150%"</span>, <span class="stringliteral">"200%"</span>, <span class="stringliteral">"400%"</span>, <span class="stringliteral">"800%"</span>, <span class="stringliteral">"1600%"</span>,
00058       QT_TRANSLATE_NOOP(<span class="stringliteral">"magTable"</span>,<span class="stringliteral">"PgeWidth"</span>),
00059       QT_TRANSLATE_NOOP(<span class="stringliteral">"magTable"</span>,<span class="stringliteral">"Page"</span>),
00060       QT_TRANSLATE_NOOP(<span class="stringliteral">"magTable"</span>,<span class="stringliteral">"DblPage"</span>),
00061      };
00062 
<a name="l00063"></a><a class="code" href="mscore_8cpp.html#a2">00063</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="mscore_8cpp.html#a2">fileOpenText</a>       = QT_TR_NOOP(<span class="stringliteral">"Load Score from File"</span>);
<a name="l00064"></a><a class="code" href="mscore_8cpp.html#a3">00064</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="mscore_8cpp.html#a3">fileSaveText</a>       = QT_TR_NOOP(<span class="stringliteral">"Save Score to File"</span>);
<a name="l00065"></a><a class="code" href="mscore_8cpp.html#a4">00065</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="mscore_8cpp.html#a4">fileNewText</a>        = QT_TR_NOOP(<span class="stringliteral">"Create New Score"</span>);
<a name="l00066"></a><a class="code" href="mscore_8cpp.html#a5">00066</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="mscore_8cpp.html#a5">filePrintText</a>      = QT_TR_NOOP(<span class="stringliteral">"Print Score"</span>);
<a name="l00067"></a><a class="code" href="mscore_8cpp.html#a6">00067</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="mscore_8cpp.html#a6">infoStartButton</a>    = QT_TR_NOOP(<span class="stringliteral">"rewind to start position"</span>);
<a name="l00068"></a><a class="code" href="mscore_8cpp.html#a7">00068</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="mscore_8cpp.html#a7">infoStopButton</a>     = QT_TR_NOOP(<span class="stringliteral">"stop sequencer"</span>);
<a name="l00069"></a><a class="code" href="mscore_8cpp.html#a8">00069</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="mscore_8cpp.html#a8">infoPlayButton</a>     = QT_TR_NOOP(<span class="stringliteral">"start sequencer play"</span>);
00070 
<a name="l00071"></a><a class="code" href="mscore_8cpp.html#a9">00071</a> <span class="keyword">static</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="mscore_8cpp.html#a9">startMag</a> = 4;
00072 
<a name="l00073"></a><a class="code" href="mscore_8cpp.html#a10">00073</a> <a class="code" href="classMscoreApplication.html">MscoreApplication</a>* <a class="code" href="app_8h.html#a0">app</a>;
<a name="l00074"></a><a class="code" href="mscore_8cpp.html#a11">00074</a> QAction* <a class="code" href="mscore_8cpp.html#a11">undoAction</a>;
<a name="l00075"></a><a class="code" href="mscore_8cpp.html#a12">00075</a> QAction* <a class="code" href="mscore_8cpp.html#a12">redoAction</a>;
<a name="l00076"></a><a class="code" href="mscore_8cpp.html#a13">00076</a> <span class="keyword">const</span> <span class="keywordtype">char</span>* <a class="code" href="mscore_8cpp.html#a13">eventRecordFile</a>;
00077 
<a name="l00078"></a><a class="code" href="mscore_8cpp.html#a14">00078</a> <span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="mscore_8cpp.html#a14">haveMidi</a>;
<a name="l00079"></a><a class="code" href="classMuseScore.html#v0">00079</a> QString* <a class="code" href="classMuseScore.html#v0">MuseScore::projectList</a>[PROJECT_LIST_LEN];
<a name="l00080"></a><a class="code" href="mscore_8cpp.html#a15">00080</a> <span class="keywordtype">int</span> <a class="code" href="globals_8h.html#a5">appDpiX</a> = 75;
<a name="l00081"></a><a class="code" href="mscore_8cpp.html#a16">00081</a> <span class="keywordtype">int</span> <a class="code" href="globals_8h.html#a6">appDpiY</a> = 75;
00082 
00083 <span class="comment">//---------------------------------------------------------</span>
00084 <span class="comment">//   printVersion</span>
00085 <span class="comment">//---------------------------------------------------------</span>
00086 
<a name="l00087"></a><a class="code" href="mscore_8cpp.html#a17">00087</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mscore_8cpp.html#a17">printVersion</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* prog)
00088       {
00089       fprintf(stderr, <span class="stringliteral">"%s: Linux Music Score Editor; Version %s\n"</span>, prog, <a class="code" href="config_8h.html#a20">VERSION</a>);
00090       }
00091 
00092 <span class="comment">//---------------------------------------------------------</span>
00093 <span class="comment">//   quitDoc</span>
00094 <span class="comment">//---------------------------------------------------------</span>
00095 
<a name="l00096"></a><a class="code" href="classMuseScore.html#k6">00096</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k6">MuseScore::quitDoc</a>()
00097       {
00098       close(<span class="keyword">true</span>);
00099       }
00100 
00101 <span class="comment">//---------------------------------------------------------</span>
00102 <span class="comment">//   closeEvent</span>
00103 <span class="comment">//---------------------------------------------------------</span>
00104 
<a name="l00105"></a><a class="code" href="classMuseScore.html#d0">00105</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#d0">MuseScore::closeEvent</a>(QCloseEvent* <span class="comment">/*ev*/</span>)
00106       {
00107       <span class="keywordflow">if</span> (!<a class="code" href="classMuseScore.html#a2">checkDirty</a>())
00108             qApp-&gt;quit();
00109       <a class="code" href="classMuseScore.html#d7">saveScoreList</a>();
00110       }
00111 
00112 <span class="comment">//---------------------------------------------------------</span>
00113 <span class="comment">//   preferencesChanged</span>
00114 <span class="comment">//---------------------------------------------------------</span>
00115 
<a name="l00116"></a><a class="code" href="classMuseScore.html#k14">00116</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k14">MuseScore::preferencesChanged</a>()
00117       {
00118       <span class="keywordflow">if</span> (<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o3">bgUseColor</a>)
00119             <a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a3">setBackground</a>(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o8">bgColor</a>);
00120       <span class="keywordflow">else</span> {
00121             QPixmap* pm = <span class="keyword">new</span> QPixmap(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o5">bgWallpaper</a>);
00122             <a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a3">setBackground</a>(pm);
00123             }
00124       <span class="keywordflow">if</span> (<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o4">fgUseColor</a>)
00125             <a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a5">setForeground</a>(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o7">fgColor</a>);
00126       <span class="keywordflow">else</span> {
00127             QPixmap* pm = <span class="keyword">new</span> QPixmap(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o6">fgWallpaper</a>);
00128             <span class="keywordflow">if</span> (pm == 0 || pm-&gt;isNull())
00129                   printf(<span class="stringliteral">"no valid pixmap %s\n"</span>, <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o6">fgWallpaper</a>.latin1());
00130             <a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a5">setForeground</a>(pm);
00131             }
00132       <a class="code" href="classMuseScore.html#r8">transportAction</a>-&gt;setEnabled(<a class="code" href="seq_8cpp.html#a0">seq</a>-&gt;<a class="code" href="classSeq.html#a4">isRunning</a>());
00133       <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;setItemChecked(<a class="code" href="classMuseScore.html#r17">transportId</a>, <a class="code" href="seq_8cpp.html#a0">seq</a>-&gt;<a class="code" href="classSeq.html#a4">isRunning</a>());
00134       <a class="code" href="classMuseScore.html#r21">transportTools</a>-&gt;setShown(<a class="code" href="seq_8cpp.html#a0">seq</a>-&gt;<a class="code" href="classSeq.html#a4">isRunning</a>());
00135       }
00136 
00137 <span class="comment">//---------------------------------------------------------</span>
00138 <span class="comment">//   Score</span>
00139 <span class="comment">//---------------------------------------------------------</span>
00140 
<a name="l00141"></a><a class="code" href="classMuseScore.html#a0">00141</a> <a class="code" href="classMuseScore.html#a0">MuseScore::MuseScore</a>()
00142    : QMainWindow()
00143       {
00144       <a class="code" href="classMuseScore.html#r0">cs</a> = 0;
00145       setCaption(QString(<span class="stringliteral">"MuseScore"</span>));
00146       <a class="code" href="classMuseScore.html#r26">textStyleDialog</a>   = 0;
00147       <a class="code" href="classMuseScore.html#r24">editStyleWin</a>      = 0;
00148       <a class="code" href="classMuseScore.html#r25">instrList</a>         = 0;
00149       <a class="code" href="classMuseScore.html#r29">playPanel</a>         = 0;
00150       <a class="code" href="classMuseScore.html#r19">preferenceDialog</a>  = 0;
00151       <a class="code" href="classMuseScore.html#r30">iledit</a>            = 0;
00152       <a class="code" href="classMuseScore.html#r31">pageListEdit</a>      = 0;
00153       <a class="code" href="classMuseScore.html#r32">measureListEdit</a>   = 0;
00154       <a class="code" href="classMuseScore.html#r34">symbolPalette1</a>    = 0;
00155       <a class="code" href="classMuseScore.html#r35">clefPalette</a>       = 0;
00156       <a class="code" href="classMuseScore.html#r36">keyPalette</a>        = 0;
00157       <a class="code" href="classMuseScore.html#r37">timePalette</a>       = 0;
00158       <a class="code" href="classMuseScore.html#r39">barPalette</a>        = 0;
00159       <a class="code" href="classMuseScore.html#r40">fingeringPalette</a>  = 0;
00160       <a class="code" href="classMuseScore.html#r38">linePalette</a>       = 0;
00161       <a class="code" href="classMuseScore.html#r42">dynamicsPalette</a>   = 0;
00162       <a class="code" href="classMuseScore.html#r33">pageSettings</a>      = 0;
00163       <a class="code" href="classMuseScore.html#r41">noteAttributesPalette</a> = 0;
00164 
00165 
00166       QWidget* mainWindow = <span class="keyword">new</span> QWidget(<span class="keyword">this</span>);
00167       <a class="code" href="classMuseScore.html#r2">layout</a> = <span class="keyword">new</span> QVBoxLayout(mainWindow);
00168       <a class="code" href="classMuseScore.html#r3">tab</a>    = <span class="keyword">new</span> QTabBar(mainWindow);
00169       <a class="code" href="classMuseScore.html#r1">canvas</a> = <span class="keyword">new</span> <a class="code" href="classCanvas.html">Canvas</a>(mainWindow);
00170       <a class="code" href="classMuseScore.html#r2">layout</a>-&gt;addWidget(<a class="code" href="classMuseScore.html#r3">tab</a>);
00171       <a class="code" href="classMuseScore.html#r2">layout</a>-&gt;addWidget(<a class="code" href="classMuseScore.html#r1">canvas</a>);
00172 
00173       connect(<a class="code" href="classMuseScore.html#r1">canvas</a>, SIGNAL(<a class="code" href="classMuseScore.html#k3">padVisible</a>(<span class="keywordtype">bool</span>)), SLOT(<a class="code" href="classMuseScore.html#k3">padVisible</a>(<span class="keywordtype">bool</span>)));
00174       connect(<a class="code" href="classMuseScore.html#r1">canvas</a>, SIGNAL(<a class="code" href="classMuseScore.html#k15">showInvisibleChanged</a>()), SLOT(<a class="code" href="classMuseScore.html#k15">showInvisibleChanged</a>()));
00175       connect(<a class="code" href="classMuseScore.html#r3">tab</a>,    SIGNAL(selected(<span class="keywordtype">int</span>)), SLOT(<a class="code" href="classMuseScore.html#i0">setCurrentScore</a>(<span class="keywordtype">int</span>)));
00176 
00177       QPixmap newIcon(filenew_xpm);
00178       QPixmap saveIcon(filesave_xpm);
00179       QPixmap printIcon(fileprint_xpm);
00180       QPixmap newIconS(filenew_xpm);
00181       QPixmap openIconS(fileopen_xpm);
00182       QPixmap openIcon(fileopen_xpm);
00183       QPixmap saveIconS(filesave_xpm);
00184       QPixmap printIconS(fileprint_xpm);
00185       QPixmap undoIconS(undoS_xpm);
00186       QPixmap undoIcon(undo_xpm);
00187       QPixmap redoIconS(redoS_xpm);
00188       QPixmap redoIcon(redo_xpm);
00189       QPixmap exitIconS(exitS_xpm);
00190       QPixmap viewmagIcon(viewmag_xpm);
00191       QPixmap viewmagIconS(viewmagS_xpm);
00192 
00193       QPixmap startIcon(start_xpm);
00194       QPixmap stopIcon(stop_xpm);
00195       QPixmap playIcon(play_xpm);
00196 
00197       QAction* whatsThis = QWhatsThis::createAction(<span class="keyword">this</span>);
00198 
00199       <span class="comment">//---------------------------------------------------</span>
00200       <span class="comment">//    Transport Action</span>
00201       <span class="comment">//---------------------------------------------------</span>
00202 
00203       <a class="code" href="classMuseScore.html#r8">transportAction</a> = <span class="keyword">new</span> QActionGroup(<span class="keyword">this</span>);
00204 
00205       QAction* startAction = <span class="keyword">new</span> QAction(QIcon(startIcon), tr(<span class="stringliteral">"Rewind"</span>), <a class="code" href="classMuseScore.html#r8">transportAction</a>);
00206       startAction-&gt;setWhatsThis(tr(<a class="code" href="mscore_8cpp.html#a6">infoStartButton</a>));
00207       connect(startAction, SIGNAL(activated()), <a class="code" href="seq_8cpp.html#a0">seq</a>, SLOT(rewindStart()));
00208 
00209       <a class="code" href="classMuseScore.html#r28">stopAction</a> = <span class="keyword">new</span> QAction(QIcon(stopIcon), tr(<span class="stringliteral">"Stop"</span>), <a class="code" href="classMuseScore.html#r8">transportAction</a>);
00210       <a class="code" href="classMuseScore.html#r28">stopAction</a>-&gt;setOn(<span class="keyword">true</span>);
00211       <a class="code" href="classMuseScore.html#r28">stopAction</a>-&gt;setWhatsThis(tr(<a class="code" href="mscore_8cpp.html#a7">infoStopButton</a>));
00212       connect(<a class="code" href="classMuseScore.html#r28">stopAction</a>, SIGNAL(toggled(<span class="keywordtype">bool</span>)), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k16">setStop</a>(<span class="keywordtype">bool</span>)));
00213 
00214       <a class="code" href="classMuseScore.html#r27">playAction</a> = <span class="keyword">new</span> QAction(QIcon(playIcon), tr(<span class="stringliteral">"Play"</span>), <a class="code" href="classMuseScore.html#r8">transportAction</a>);
00215       <a class="code" href="classMuseScore.html#r27">playAction</a>-&gt;setWhatsThis(tr(<a class="code" href="mscore_8cpp.html#a8">infoPlayButton</a>));
00216       connect(<a class="code" href="classMuseScore.html#r27">playAction</a>, SIGNAL(toggled(<span class="keywordtype">bool</span>)), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k17">setPlay</a>(<span class="keywordtype">bool</span>)));
00217 
00218       <a class="code" href="classMuseScore.html#r8">transportAction</a>-&gt;addAction(startAction);
00219       <a class="code" href="classMuseScore.html#r8">transportAction</a>-&gt;addAction(<a class="code" href="classMuseScore.html#r28">stopAction</a>);
00220       <a class="code" href="classMuseScore.html#r8">transportAction</a>-&gt;addAction(<a class="code" href="classMuseScore.html#r27">playAction</a>);
00221 
00222       <span class="comment">//---------------------------------------------------</span>
00223       <span class="comment">//    File Action</span>
00224       <span class="comment">//---------------------------------------------------</span>
00225 
00226       QAction* fileNewAction = <span class="keyword">new</span> QAction(QIcon(newIcon), tr(<span class="stringliteral">"&amp;New"</span>), <span class="keyword">this</span>);
00227       fileNewAction-&gt;setToolTip(tr(<a class="code" href="mscore_8cpp.html#a4">fileNewText</a>));
00228 
00229       QAction* fileOpenAction = <span class="keyword">new</span> QAction(QIcon(openIcon), tr(<span class="stringliteral">"&amp;Open"</span>), <span class="keyword">this</span>);
00230       fileOpenAction-&gt;setToolTip(tr(<a class="code" href="mscore_8cpp.html#a2">fileOpenText</a>));
00231 
00232       QAction* fileSaveAction = <span class="keyword">new</span> QAction(QIcon(saveIcon), tr(<span class="stringliteral">"&amp;Save"</span>), <span class="keyword">this</span>);
00233       fileSaveAction-&gt;setToolTip(tr(<a class="code" href="mscore_8cpp.html#a3">fileSaveText</a>));
00234 
00235       QAction* filePrintAction = <span class="keyword">new</span> QAction(QIcon(printIcon), tr(<span class="stringliteral">"&amp;Print"</span>), <span class="keyword">this</span>);
00236       filePrintAction-&gt;setToolTip(tr(<a class="code" href="mscore_8cpp.html#a5">filePrintText</a>));
00237 
00238       QActionGroup* undoRedo = <span class="keyword">new</span> QActionGroup(<span class="keyword">this</span>);
00239 
00240       <a class="code" href="mscore_8cpp.html#a11">undoAction</a> = <span class="keyword">new</span> QAction(QIcon(undoIcon), tr(<span class="stringliteral">"Und&amp;o"</span>), undoRedo);
00241       <a class="code" href="mscore_8cpp.html#a12">redoAction</a> = <span class="keyword">new</span> QAction(QIcon(redoIcon), tr(<span class="stringliteral">"Re&amp;do"</span>), undoRedo);
00242       <a class="code" href="mscore_8cpp.html#a11">undoAction</a>-&gt;setWhatsThis(tr(<span class="stringliteral">"undo last change"</span>));
00243       <a class="code" href="mscore_8cpp.html#a11">undoAction</a>-&gt;setStatusTip(tr(<span class="stringliteral">"undo last change"</span>));
00244       <a class="code" href="mscore_8cpp.html#a12">redoAction</a>-&gt;setWhatsThis(tr(<span class="stringliteral">"redo last undo"</span>));
00245 
00246       connect(<a class="code" href="mscore_8cpp.html#a12">redoAction</a>,      SIGNAL(activated()), SLOT(<a class="code" href="classMuseScore.html#k46">doRedo</a>()));
00247       connect(<a class="code" href="mscore_8cpp.html#a11">undoAction</a>,      SIGNAL(activated()), SLOT(<a class="code" href="classMuseScore.html#k47">doUndo</a>()));
00248 
00249       connect(filePrintAction, SIGNAL(activated()), SLOT(<a class="code" href="classMuseScore.html#k48">printFile</a>()));
00250       connect(fileNewAction,   SIGNAL(activated()), SLOT(<a class="code" href="classMuseScore.html#k27">newFile</a>()));
00251       connect(fileOpenAction,  SIGNAL(activated()), SLOT(<a class="code" href="classMuseScore.html#k24">loadFile</a>()));
00252       connect(fileSaveAction,  SIGNAL(activated()), SLOT(<a class="code" href="classMuseScore.html#k25">saveFile</a>()));
00253 
00254       <span class="comment">//---------------------</span>
00255       <span class="comment">//    Tool Bar</span>
00256       <span class="comment">//---------------------</span>
00257 
00258       <a class="code" href="classMuseScore.html#r20">fileTools</a> = <span class="keyword">new</span> QToolBar(tr(<span class="stringliteral">"File Operations"</span>), <span class="keyword">this</span>);
00259       addToolBar(<a class="code" href="classMuseScore.html#r20">fileTools</a>);
00260 
00261       fileNewAction-&gt;addTo(<a class="code" href="classMuseScore.html#r20">fileTools</a>);
00262       fileOpenAction-&gt;addTo(<a class="code" href="classMuseScore.html#r20">fileTools</a>);
00263       fileSaveAction-&gt;addTo(<a class="code" href="classMuseScore.html#r20">fileTools</a>);
00264       filePrintAction-&gt;addTo(<a class="code" href="classMuseScore.html#r20">fileTools</a>);
00265       whatsThis-&gt;addTo(<a class="code" href="classMuseScore.html#r20">fileTools</a>);
00266       <a class="code" href="classMuseScore.html#r20">fileTools</a>-&gt;addSeparator();
00267       undoRedo-&gt;addTo(<a class="code" href="classMuseScore.html#r20">fileTools</a>);
00268       <a class="code" href="classMuseScore.html#r20">fileTools</a>-&gt;addSeparator();
00269 
00270       <a class="code" href="classMuseScore.html#r21">transportTools</a> = <span class="keyword">new</span> QToolBar(tr(<span class="stringliteral">"Transport Tools"</span>), <span class="keyword">this</span>);
00271       addToolBar(<a class="code" href="classMuseScore.html#r21">transportTools</a>);
00272       <a class="code" href="classMuseScore.html#r8">transportAction</a>-&gt;addTo(<a class="code" href="classMuseScore.html#r21">transportTools</a>);
00273 
00274       QToolButton* tb = <span class="keyword">new</span> QToolButton(QIcon(viewmagIcon),
00275          tr(<span class="stringliteral">"Mag"</span>), tr(<span class="stringliteral">"Mag"</span>), <a class="code" href="classMuseScore.html#r1">canvas</a>, SLOT(magCanvas()), <a class="code" href="classMuseScore.html#r20">fileTools</a>);
00276       <a class="code" href="classMuseScore.html#r20">fileTools</a>-&gt;addWidget(tb);
00277 
00278       <a class="code" href="classMuseScore.html#r7">mag</a> = <span class="keyword">new</span> QComboBox(<span class="keyword">true</span>, <a class="code" href="classMuseScore.html#r20">fileTools</a>, <span class="stringliteral">"mags"</span>);
00279       <a class="code" href="classMuseScore.html#r7">mag</a>-&gt;setValidator(<span class="keyword">new</span> QDoubleValidator(.05, 20.0, 2, <a class="code" href="classMuseScore.html#r7">mag</a>));
00280       <a class="code" href="classMuseScore.html#r7">mag</a>-&gt;setInsertionPolicy(QComboBox::NoInsertion);
00281       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i =  0; i &lt; <span class="keyword">sizeof</span>(<a class="code" href="mscore_8cpp.html#a1">magTable</a>)/<span class="keyword">sizeof</span>(*magTable); ++i) {
00282             <a class="code" href="classMuseScore.html#r7">mag</a>-&gt;insertItem(tr(<a class="code" href="mscore_8cpp.html#a1">magTable</a>[i]), i);
00283             <span class="keywordflow">if</span> (i == <a class="code" href="mscore_8cpp.html#a9">startMag</a>)
00284                   <a class="code" href="classMuseScore.html#r7">mag</a>-&gt;setCurrentItem(i);
00285             }
00286       <a class="code" href="classMuseScore.html#r20">fileTools</a>-&gt;addWidget(<a class="code" href="classMuseScore.html#r7">mag</a>);
00287       addToolBarBreak();
00288 
00289       <span class="comment">//-------------------------------</span>
00290       <span class="comment">//    Note Entry Tool Bar</span>
00291       <span class="comment">//-------------------------------</span>
00292 
00293       <span class="keyword">struct </span>{
00294             <span class="keywordtype">int</span> <span class="keywordtype">id</span>;
00295             <span class="keywordtype">bool</span> toggleButton;
00296             QIcon* is;
00297             <span class="keyword">const</span> <span class="keywordtype">char</span>** pm;        <span class="comment">// icon pixmap</span>
00298             <span class="keyword">const</span> <span class="keywordtype">char</span>* tt;         <span class="comment">// tool tip</span>
00299             } ne[] = {
00300             { <a class="code" href="padids_8h.html#a29a0">PAD_NOTE1</a>,  <span class="keyword">true</span>, &amp;<a class="code" href="icons_8cpp.html#a0">noteIcon</a>,       0,  <span class="stringliteral">"1/1"</span> },
00301             { <a class="code" href="padids_8h.html#a29a1">PAD_NOTE2</a>,  <span class="keyword">true</span>, &amp;<a class="code" href="icons_8cpp.html#a1">note2Icon</a>,      0,  <span class="stringliteral">"1/2"</span> },
00302             { <a class="code" href="padids_8h.html#a29a2">PAD_NOTE4</a>,  <span class="keyword">true</span>, &amp;<a class="code" href="icons_8cpp.html#a2">note4Icon</a>,      0, <span class="stringliteral">"1/4"</span> },
00303             { <a class="code" href="padids_8h.html#a29a3">PAD_NOTE8</a>,  <span class="keyword">true</span>, &amp;<a class="code" href="icons_8cpp.html#a3">note8Icon</a>,      0, <span class="stringliteral">"1/8"</span> },
00304             { <a class="code" href="padids_8h.html#a29a4">PAD_NOTE16</a>, <span class="keyword">true</span>, &amp;<a class="code" href="icons_8cpp.html#a4">note16Icon</a>,     0, <span class="stringliteral">"1/16"</span> },
00305             { <a class="code" href="padids_8h.html#a29a5">PAD_NOTE32</a>, <span class="keyword">true</span>, &amp;<a class="code" href="icons_8cpp.html#a5">note32Icon</a>,     0, <span class="stringliteral">"1/32"</span> },
00306             { <a class="code" href="padids_8h.html#a29a6">PAD_NOTE64</a>, <span class="keyword">true</span>, &amp;<a class="code" href="icons_8cpp.html#a6">note64Icon</a>,     0, <span class="stringliteral">"1/64"</span> },
00307             { <a class="code" href="padids_8h.html#a29a8">PAD_DOT</a>,    <span class="keyword">true</span>, &amp;<a class="code" href="icons_8cpp.html#a13">dotIcon</a>,        0, QT_TR_NOOP(<span class="stringliteral">"dot"</span>) },
00308             { <a class="code" href="padids_8h.html#a29a16">PAD_TIE</a>,    <span class="keyword">true</span>, 0,               0, QT_TR_NOOP(<span class="stringliteral">"tie"</span>) },
00309             { -1, <span class="keyword">false</span>, 0, 0, 0 },
00310             { <a class="code" href="padids_8h.html#a29a7">PAD_REST</a>,   <span class="keyword">true</span>, &amp;<a class="code" href="icons_8cpp.html#a12">quartrestIcon</a>,  0, QT_TR_NOOP(<span class="stringliteral">"rest"</span>) },
00311             { -1, <span class="keyword">false</span>, 0, 0, 0 },
00312             { <a class="code" href="padids_8h.html#a29a9">PAD_SHARP2</a>, <span class="keyword">true</span>, &amp;<a class="code" href="icons_8cpp.html#a9">sharpsharpIcon</a>, 0, QT_TR_NOOP(<span class="stringliteral">"double sharp"</span>) },
00313             { <a class="code" href="padids_8h.html#a29a10">PAD_SHARP</a>,  <span class="keyword">true</span>, &amp;<a class="code" href="icons_8cpp.html#a8">sharpIcon</a>,      0, QT_TR_NOOP(<span class="stringliteral">"sharp"</span>) },
00314             { <a class="code" href="padids_8h.html#a29a11">PAD_NAT</a>,    <span class="keyword">true</span>, &amp;<a class="code" href="icons_8cpp.html#a7">naturalIcon</a>,    0, QT_TR_NOOP(<span class="stringliteral">"natural"</span>) },
00315             { <a class="code" href="padids_8h.html#a29a12">PAD_FLAT</a>,   <span class="keyword">true</span>, &amp;<a class="code" href="icons_8cpp.html#a10">flatIcon</a>,       0, QT_TR_NOOP(<span class="stringliteral">"flat"</span>) },
00316             { <a class="code" href="padids_8h.html#a29a13">PAD_FLAT2</a>,  <span class="keyword">true</span>, &amp;<a class="code" href="icons_8cpp.html#a11">flatflatIcon</a>,   0, QT_TR_NOOP(<span class="stringliteral">"double flat"</span>) },
00317             { -1, <span class="keyword">false</span>, 0, 0, 0 },
00318             { <a class="code" href="padids_8h.html#a29a20">PAD_FLIP</a>,   <span class="keyword">false</span>, 0,       flip_xpm, QT_TR_NOOP(<span class="stringliteral">"flip stem"</span>) },
00319             };
00320 
00321       <a class="code" href="classMuseScore.html#r22">entryTools</a> = <span class="keyword">new</span> QToolBar(tr(<span class="stringliteral">"Note Entry"</span>), <span class="keyword">this</span>);
00322       addToolBar(<a class="code" href="classMuseScore.html#r22">entryTools</a>);
00323 
00324       <span class="keywordtype">int</span> n = 0;
00325       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = 0; i &lt; <span class="keyword">sizeof</span>(ne)/<span class="keyword">sizeof</span>(*ne); ++i) {
00326             <span class="keywordtype">int</span> <span class="keywordtype">id</span> = ne[i].id;
00327             <span class="keywordflow">if</span> (<span class="keywordtype">id</span> &lt; 0)
00328                   <a class="code" href="classMuseScore.html#r22">entryTools</a>-&gt;addSeparator();
00329             <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == <a class="code" href="padids_8h.html#a29a16">PAD_TIE</a>) {
00330                   <a class="code" href="classMuseScore.html#r12">entryTb</a>[n] = <span class="keyword">new</span> <a class="code" href="classToolButton.html">ToolButton</a>(<span class="keywordtype">id</span>, tr(ne[i].tt),  <span class="stringliteral">"+"</span>, <a class="code" href="classMuseScore.html#r22">entryTools</a>);
00331                   <a class="code" href="classMuseScore.html#r12">entryTb</a>[n]-&gt;setIconSize(QSize(ICON_SIZE, ICON_SIZE));
00332                   <a class="code" href="classMuseScore.html#r22">entryTools</a>-&gt;addWidget(<a class="code" href="classMuseScore.html#r12">entryTb</a>[n]);
00333                   <a class="code" href="classMuseScore.html#r12">entryTb</a>[n]-&gt;setToggleButton(<span class="keyword">true</span>);
00334                   connect(<a class="code" href="classMuseScore.html#r12">entryTb</a>[n], SIGNAL(cclicked(<span class="keywordtype">int</span>)), SLOT(<a class="code" href="classMuseScore.html#k49">padToggle</a>(<span class="keywordtype">int</span>)));
00335                   ++n;
00336                   }
00337             <span class="keywordflow">else</span> {
00338                   <span class="keywordflow">if</span> (ne[i].pm)
00339                         <a class="code" href="classMuseScore.html#r12">entryTb</a>[n] = <span class="keyword">new</span> <a class="code" href="classToolButton.html">ToolButton</a>(<span class="keywordtype">id</span>, tr(ne[i].tt), QPixmap(ne[i].pm), <a class="code" href="classMuseScore.html#r22">entryTools</a>);
00340                   <span class="keywordflow">else</span>
00341                         <a class="code" href="classMuseScore.html#r12">entryTb</a>[n] = <span class="keyword">new</span> ToolButton(<span class="keywordtype">id</span>, tr(ne[i].tt), QPixmap(), <a class="code" href="classMuseScore.html#r22">entryTools</a>);
00342                   <a class="code" href="classMuseScore.html#r12">entryTb</a>[n]-&gt;setToggleButton(ne[i].toggleButton);
00343                   <a class="code" href="classMuseScore.html#r22">entryTools</a>-&gt;addWidget(<a class="code" href="classMuseScore.html#r12">entryTb</a>[n]);
00344                   <span class="keywordflow">if</span> (ne[i].is) {
00345                         <a class="code" href="classMuseScore.html#r12">entryTb</a>[n]-&gt;setIconSet(*(ne[i].is));
00346                         }
00347                   connect(<a class="code" href="classMuseScore.html#r12">entryTb</a>[n], SIGNAL(cclicked(<span class="keywordtype">int</span>)), SLOT(<a class="code" href="classMuseScore.html#k49">padToggle</a>(<span class="keywordtype">int</span>)));
00348                   ++n;
00349                   }
00350             }
00351 
00352       <a class="code" href="classMuseScore.html#r23">voiceTools</a> = <span class="keyword">new</span> QToolBar(tr(<span class="stringliteral">"Voice Select"</span>), <span class="keyword">this</span>);
00353       addToolBar(<a class="code" href="classMuseScore.html#r23">voiceTools</a>);
00354       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="globals_8h.html#a3">VOICES</a>; ++i) {
00355             QString tip = QString(<span class="stringliteral">"voice %1"</span>).arg(i+1);
00356             QString txt = QString(<span class="stringliteral">"%1"</span>).arg(i+1);
00357             <a class="code" href="classMuseScore.html#r13">voiceTb</a>[i] = <span class="keyword">new</span> <a class="code" href="classToolButton.html">ToolButton</a>(<a class="code" href="padids_8h.html#a29a25">PAD_VOICE0</a>+i, tip, txt, <a class="code" href="classMuseScore.html#r23">voiceTools</a>);
00358             QPalette p = <a class="code" href="classMuseScore.html#r13">voiceTb</a>[i]-&gt;palette();
00359             p.setColor(QPalette::Active, QColorGroup::Button, <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o9">selectColor</a>[i].light(160));
00360             voiceTb[i]-&gt;setPalette(p);
00361             connect(voiceTb[i], SIGNAL(cclicked(<span class="keywordtype">int</span>)), SLOT(<a class="code" href="classMuseScore.html#k49">padToggle</a>(<span class="keywordtype">int</span>)));
00362             <a class="code" href="classMuseScore.html#r23">voiceTools</a>-&gt;addWidget(voiceTb[i]);
00363             }
00364 
00365       <span class="comment">//---------------------</span>
00366       <span class="comment">//    Menus</span>
00367       <span class="comment">//---------------------</span>
00368 
00369       QMenuBar* mb = <span class="keyword">new</span> QMenuBar(<span class="keyword">this</span>);
00370       setMenuBar(mb);
00371 
00372       <span class="comment">//---------------------</span>
00373       <span class="comment">//    Menu File</span>
00374       <span class="comment">//---------------------</span>
00375 
00376       QMenu* menuFile = <span class="keyword">new</span> QMenu(<span class="keyword">this</span>);
00377       mb-&gt;addMenu(menuFile);
00378 
00379       menuBar()-&gt;insertItem(tr(<span class="stringliteral">"&amp;File"</span>), menuFile);
00380       fileNewAction-&gt;addTo(menuFile);
00381       fileOpenAction-&gt;addTo(menuFile);
00382       <a class="code" href="classMuseScore.html#r6">openRecent</a> = <span class="keyword">new</span> QMenu(<span class="keyword">this</span>);
00383       connect(<a class="code" href="classMuseScore.html#r6">openRecent</a>, SIGNAL(aboutToShow()), SLOT(<a class="code" href="classMuseScore.html#k4">openRecentMenu</a>()));
00384       connect(<a class="code" href="classMuseScore.html#r6">openRecent</a>, SIGNAL(activated(<span class="keywordtype">int</span>)), SLOT(<a class="code" href="classMuseScore.html#k5">selectScore</a>(<span class="keywordtype">int</span>)));
00385       menuFile-&gt;insertItem(tr(<span class="stringliteral">"Open &amp;Recent"</span>), <a class="code" href="classMuseScore.html#r6">openRecent</a>, Qt::CTRL + Qt::Key_S);
00386       menuFile-&gt;insertSeparator();
00387       fileSaveAction-&gt;addTo(menuFile);
00388       menuFile-&gt;insertItem(QIcon(saveIcon), tr(<span class="stringliteral">"Save &amp;As"</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k26">saveAs</a>()), Qt::CTRL + Qt::Key_A);
00389       menuFile-&gt;insertSeparator();
00390       menuFile-&gt;insertItem(QIcon(saveIcon), tr(<span class="stringliteral">"Export Midi"</span>),     <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k20">exportMidi</a>()));
00391       menuFile-&gt;insertItem(QIcon(saveIcon), tr(<span class="stringliteral">"Export MusicXML"</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k23">exportMusicXml</a>()));
00392       menuFile-&gt;insertItem(QIcon(openIcon), tr(<span class="stringliteral">"Import Midi"</span>),     <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k21">importMidi</a>()));
00393       menuFile-&gt;insertItem(QIcon(openIcon), tr(<span class="stringliteral">"Import MusicXML"</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k22">importMusicXml</a>()));
00394       menuFile-&gt;insertSeparator();
00395       filePrintAction-&gt;addTo(menuFile);
00396       menuFile-&gt;insertSeparator();
00397       menuFile-&gt;insertItem(exitIconS, tr(<span class="stringliteral">"&amp;Quit"</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k6">quitDoc</a>()), Qt::CTRL + Qt::Key_Q, -2);
00398 
00399       <span class="comment">//---------------------</span>
00400       <span class="comment">//    Menu Edit</span>
00401       <span class="comment">//---------------------</span>
00402 
00403       <a class="code" href="classMuseScore.html#r5">menuEdit</a> = <span class="keyword">new</span> QMenu(<span class="keyword">this</span>);
00404       mb-&gt;addMenu(<a class="code" href="classMuseScore.html#r5">menuEdit</a>);
00405 
00406       undoRedo-&gt;addTo(<a class="code" href="classMuseScore.html#r5">menuEdit</a>);
00407       <a class="code" href="classMuseScore.html#r5">menuEdit</a>-&gt;insertSeparator();
00408       menuBar()-&gt;insertItem(tr(<span class="stringliteral">"&amp;Edit"</span>), <a class="code" href="classMuseScore.html#r5">menuEdit</a>);
00409 
00410       <a class="code" href="classMuseScore.html#r14">cutId</a> = <a class="code" href="classMuseScore.html#r5">menuEdit</a>-&gt;insertItem(QIcon(QPixmap(editcut_xpm)), tr(<span class="stringliteral">"C&amp;ut"</span>),  <a class="code" href="classMuseScore.html#r1">canvas</a>, SLOT(cmdCut()));
00411       <a class="code" href="classMuseScore.html#r5">menuEdit</a>-&gt;setAccel(Qt::CTRL + Qt::Key_X, <a class="code" href="classMuseScore.html#r14">cutId</a>);
00412       <a class="code" href="classMuseScore.html#r15">copyId</a> = <a class="code" href="classMuseScore.html#r5">menuEdit</a>-&gt;insertItem(QIcon(QPixmap(editcopy_xpm)), tr(<span class="stringliteral">"&amp;Copy"</span>),  <a class="code" href="classMuseScore.html#r1">canvas</a>, SLOT(cmdCopy()));
00413       <a class="code" href="classMuseScore.html#r5">menuEdit</a>-&gt;setAccel(Qt::CTRL + Qt::Key_C, <a class="code" href="classMuseScore.html#r15">copyId</a>);
00414       <a class="code" href="classMuseScore.html#r16">pasteId</a> = <a class="code" href="classMuseScore.html#r5">menuEdit</a>-&gt;insertItem(QIcon(QPixmap(editpaste_xpm)), tr(<span class="stringliteral">"&amp;Paste"</span>), <a class="code" href="classMuseScore.html#r1">canvas</a>, SLOT(cmdPaste()));
00415       <a class="code" href="classMuseScore.html#r5">menuEdit</a>-&gt;setAccel(Qt::CTRL + Qt::Key_V, <a class="code" href="classMuseScore.html#r16">pasteId</a>);
00416       <a class="code" href="classMuseScore.html#k9">selectionChanged</a>(0);
00417       <a class="code" href="classMuseScore.html#r5">menuEdit</a>-&gt;insertSeparator();
00418       <a class="code" href="classMuseScore.html#r5">menuEdit</a>-&gt;insertItem(tr(<span class="stringliteral">"Instrument List..."</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k11">startInstrumentListEditor</a>()));
00419       <a class="code" href="classMuseScore.html#r5">menuEdit</a>-&gt;insertSeparator();
00420       <a class="code" href="classMuseScore.html#r5">menuEdit</a>-&gt;insertItem(tr(<span class="stringliteral">"Page List..."</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k12">startPageListEditor</a>()));
00421       <a class="code" href="classMuseScore.html#r5">menuEdit</a>-&gt;insertSeparator();
00422       <a class="code" href="classMuseScore.html#r5">menuEdit</a>-&gt;insertItem(tr(<span class="stringliteral">"Preferences..."</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k10">startPreferenceDialog</a>()));
00423 
00424       <span class="comment">//---------------------</span>
00425       <span class="comment">//    Menu Create</span>
00426       <span class="comment">//---------------------</span>
00427 
00428       QMenu* menuCreate = <a class="code" href="mscore_8h.html#a2">genCreateMenu</a>(<span class="keyword">this</span>);
00429       mb-&gt;addMenu(menuCreate);
00430 
00431       menuBar()-&gt;insertItem(tr(<span class="stringliteral">"&amp;Create"</span>), menuCreate);
00432 
00433       <span class="comment">//---------------------</span>
00434       <span class="comment">//    Menu Notes</span>
00435       <span class="comment">//---------------------</span>
00436 
00437       QMenu* menuNotes = <span class="keyword">new</span> QMenu(<span class="keyword">this</span>);
00438       mb-&gt;addMenu(menuNotes);
00439 
00440       menuNotes-&gt;setCheckable(<span class="keyword">false</span>);
00441       menuBar()-&gt;insertItem(tr(<span class="stringliteral">"Notes"</span>), menuNotes);
00442       menuNotes-&gt;insertItem(tr(<span class="stringliteral">"Input"</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k64">startNoteEntry</a>()), Qt::Key_N, -1);
00443       menuNotes-&gt;insertSeparator();
00444 
00445       QMenu* menuAddPitch = <span class="keyword">new</span> QMenu(<span class="keyword">this</span>);
00446       menuAddPitch-&gt;setCheckable(<span class="keyword">false</span>);
00447       menuAddPitch-&gt;insertItem(<span class="stringliteral">"A"</span>, 0);
00448       menuAddPitch-&gt;insertItem(<span class="stringliteral">"B"</span>, 1);
00449       menuAddPitch-&gt;insertItem(<span class="stringliteral">"C"</span>, 2);
00450       menuAddPitch-&gt;insertItem(<span class="stringliteral">"D"</span>, 3);
00451       menuAddPitch-&gt;insertItem(<span class="stringliteral">"E"</span>, 4);
00452       menuAddPitch-&gt;insertItem(<span class="stringliteral">"F"</span>, 5);
00453       menuAddPitch-&gt;insertItem(<span class="stringliteral">"G"</span>, 6);
00454       menuAddPitch-&gt;setAccel(Qt::SHIFT + Qt::Key_A, 0);
00455       menuAddPitch-&gt;setAccel(Qt::SHIFT + Qt::Key_B, 1);
00456       menuAddPitch-&gt;setAccel(Qt::SHIFT + Qt::Key_C, 2);
00457       menuAddPitch-&gt;setAccel(Qt::SHIFT + Qt::Key_D, 3);
00458       menuAddPitch-&gt;setAccel(Qt::SHIFT + Qt::Key_E, 4);
00459       menuAddPitch-&gt;setAccel(Qt::SHIFT + Qt::Key_F, 5);
00460       menuAddPitch-&gt;setAccel(Qt::SHIFT + Qt::Key_G, 6);
00461       menuNotes-&gt;insertItem(tr(<span class="stringliteral">"Add Pitch"</span>), menuAddPitch);
00462       connect(menuAddPitch, SIGNAL(activated(<span class="keywordtype">int</span>)), SLOT(<a class="code" href="classMuseScore.html#k50">cmdAddPitch</a>(<span class="keywordtype">int</span>)));
00463 
00464       QMenu* menuAddIntervall = <span class="keyword">new</span> QMenu(<span class="keyword">this</span>);
00465       menuAddIntervall-&gt;setCheckable(<span class="keyword">false</span>);
00466       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"Prime"</span>),         1);
00467       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"Sekunde above"</span>), 2);
00468       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"Terz above"</span>),    3);
00469       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"Quart above"</span>),   4);
00470       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"Quinte above"</span>),  5);
00471       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"Sexte above"</span>),   6);
00472       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"Septime above"</span>), 7);
00473       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"Oktave above"</span>),  8);
00474       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"None above"</span>),    9);
00475       menuAddIntervall-&gt;insertSeparator();
00476       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"Sekunde below"</span>), 12);
00477       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"Terz below"</span>),    13);
00478       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"Quart below"</span>),   14);
00479       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"Quinte below"</span>),  15);
00480       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"Sexte below"</span>),   16);
00481       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"Septime below"</span>), 17);
00482       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"Oktave below"</span>),  18);
00483       menuAddIntervall-&gt;insertItem(tr(<span class="stringliteral">"None below"</span>),    19);
00484       menuAddIntervall-&gt;setAccel(Qt::Key_1, 1);
00485       menuAddIntervall-&gt;setAccel(Qt::Key_2, 2);
00486       menuAddIntervall-&gt;setAccel(Qt::Key_3, 3);
00487       menuAddIntervall-&gt;setAccel(Qt::Key_4, 4);
00488       menuAddIntervall-&gt;setAccel(Qt::Key_5, 5);
00489       menuAddIntervall-&gt;setAccel(Qt::Key_6, 6);
00490       menuAddIntervall-&gt;setAccel(Qt::Key_7, 7);
00491       menuAddIntervall-&gt;setAccel(Qt::Key_8, 8);
00492       menuAddIntervall-&gt;setAccel(Qt::Key_9, 9);
00493 
00494       <span class="comment">// does not really work; look for hack in keyb.cpp</span>
00495       menuAddIntervall-&gt;setAccel(Qt::SHIFT+Qt::Key_2, 12);
00496       menuAddIntervall-&gt;setAccel(Qt::SHIFT+Qt::Key_3, 13);
00497       menuAddIntervall-&gt;setAccel(Qt::SHIFT+Qt::Key_4, 14);
00498       menuAddIntervall-&gt;setAccel(Qt::SHIFT+Qt::Key_5, 15);
00499       menuAddIntervall-&gt;setAccel(Qt::SHIFT+Qt::Key_6, 16);
00500       menuAddIntervall-&gt;setAccel(Qt::SHIFT+Qt::Key_7, 17);
00501       menuAddIntervall-&gt;setAccel(Qt::SHIFT+Qt::Key_8, 18);
00502       menuAddIntervall-&gt;setAccel(Qt::SHIFT+Qt::Key_9, 19);
00503 
00504       menuNotes-&gt;insertItem(tr(<span class="stringliteral">"Add Intervall"</span>), menuAddIntervall);
00505       connect(menuAddIntervall, SIGNAL(activated(<span class="keywordtype">int</span>)), SLOT(<a class="code" href="classMuseScore.html#k51">cmdAddIntervall</a>(<span class="keywordtype">int</span>)));
00506 
00507       QMenu* menuNtole = <span class="keyword">new</span> QMenu(<span class="keyword">this</span>);
00508 <span class="comment">//      mb-&gt;addMenu(menuNtole);</span>
00509 
00510       menuNtole-&gt;setCheckable(<span class="keyword">false</span>);
00511       menuNtole-&gt;insertItem(<span class="stringliteral">"duole"</span>, 2);
00512       menuNtole-&gt;insertItem(<span class="stringliteral">"triole"</span>, 3);
00513       menuNtole-&gt;insertItem(<span class="stringliteral">"pentole"</span>, 5);
00514       menuNtole-&gt;setAccel(Qt::CTRL+Qt::Key_2, 2);
00515       menuNtole-&gt;setAccel(Qt::CTRL+Qt::Key_3, 3);
00516       menuNtole-&gt;setAccel(Qt::CTRL+Qt::Key_5, 5);
00517       menuNotes-&gt;insertItem(tr(<span class="stringliteral">"N-Tole"</span>), menuNtole);
00518       connect(menuNtole, SIGNAL(activated(<span class="keywordtype">int</span>)), SLOT(<a class="code" href="classMuseScore.html#k52">cmdNTole</a>(<span class="keywordtype">int</span>)));
00519 
00520       <span class="comment">//---------------------</span>
00521       <span class="comment">//    Menu Layout</span>
00522       <span class="comment">//---------------------</span>
00523 
00524       QMenu* menuLayout = <span class="keyword">new</span> QMenu(<span class="keyword">this</span>);
00525       mb-&gt;addMenu(menuLayout);
00526 
00527       menuLayout-&gt;setCheckable(<span class="keyword">false</span>);
00528       menuBar()-&gt;insertItem(tr(<span class="stringliteral">"&amp;Layout"</span>), menuLayout);
00529       menuLayout-&gt;insertItem(tr(<span class="stringliteral">"Page Settings..."</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k70">showPageSettings</a>()));
00530       menuLayout-&gt;insertItem(tr(<span class="stringliteral">"Reset Positions"</span>),  <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k68">resetUserOffsets</a>()));
00531       menuLayout-&gt;insertItem(tr(<span class="stringliteral">"Set Normal Staff Distances"</span>),  <a class="code" href="classMuseScore.html#r1">canvas</a>, SLOT(resetStaffOffsets()));
00532       menuLayout-&gt;insertItem(tr(<span class="stringliteral">"Reset Stretch"</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k65">resetUserStretch</a>()));
00533       menuLayout-&gt;insertItem(tr(<span class="stringliteral">"System Break"</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k66">systemBreak</a>()));
00534       menuLayout-&gt;insertItem(tr(<span class="stringliteral">"Page Break"</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k67">pageBreak</a>()));
00535 
00536       <span class="comment">//---------------------</span>
00537       <span class="comment">//    Menu Style</span>
00538       <span class="comment">//---------------------</span>
00539 
00540       QMenu* menuStyle = <span class="keyword">new</span> QMenu(<span class="keyword">this</span>);
00541       mb-&gt;addMenu(menuStyle);
00542 
00543       menuStyle-&gt;setCheckable(<span class="keyword">false</span>);
00544       menuBar()-&gt;insertItem(tr(<span class="stringliteral">"&amp;Style"</span>), menuStyle);
00545       menuStyle-&gt;insertItem(tr(<span class="stringliteral">"Edit Style..."</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k28">editStyle</a>()));
00546       menuStyle-&gt;insertItem(tr(<span class="stringliteral">"Edit Text Style..."</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k32">editTextStyle</a>()));
00547       menuStyle-&gt;insertSeparator();
00548       menuStyle-&gt;insertItem(QIcon(openIcon), tr(<span class="stringliteral">"Load Style"</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k30">loadStyle</a>()));
00549       menuStyle-&gt;insertItem(QIcon(saveIcon), tr(<span class="stringliteral">"Save Style"</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k29">saveStyle</a>()));
00550 
00551       <span class="comment">//---------------------</span>
00552       <span class="comment">//    Menu Display</span>
00553       <span class="comment">//---------------------</span>
00554 
00555       <a class="code" href="classMuseScore.html#r4">menuDisplay</a> = <span class="keyword">new</span> QMenu(<span class="keyword">this</span>);
00556       mb-&gt;addMenu(<a class="code" href="classMuseScore.html#r4">menuDisplay</a>);
00557 
00558       menuBar()-&gt;insertItem(tr(<span class="stringliteral">"&amp;Display"</span>), <a class="code" href="classMuseScore.html#r4">menuDisplay</a>);
00559       <a class="code" href="classMuseScore.html#r9">padId</a> = <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;insertItem(tr(<span class="stringliteral">"Pad"</span>), <a class="code" href="classMuseScore.html#r1">canvas</a>, SLOT(showPad()), Qt::Key_F10);
00560       <a class="code" href="classMuseScore.html#r10">playId</a> = <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;insertItem(tr(<span class="stringliteral">"PlayPanel"</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k35">togglePlayPanel</a>()), Qt::Key_F11);
00561       <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;insertSeparator();
00562       <a class="code" href="classMuseScore.html#r17">transportId</a> = <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;insertItem(tr(<span class="stringliteral">"Transport Toolbar"</span>), <span class="keyword">this</span>,
00563          SLOT(<a class="code" href="classMuseScore.html#k18">toggleTransportToolbar</a>()));
00564       <a class="code" href="classMuseScore.html#r18">inputId</a> = <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;insertItem(tr(<span class="stringliteral">"Note Input Toolbar"</span>), <span class="keyword">this</span>,
00565          SLOT(<a class="code" href="classMuseScore.html#k19">toggleInputToolbar</a>()));
00566       <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;setItemChecked(<a class="code" href="classMuseScore.html#r18">inputId</a>, <span class="keyword">true</span>);
00567 
00568       <span class="comment">// if we have no sequencer, disable transport and play panel</span>
00569       <span class="keywordflow">if</span> (!<a class="code" href="seq_8cpp.html#a0">seq</a>-&gt;<a class="code" href="classSeq.html#a4">isRunning</a>()) {
00570             <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;setItemEnabled(<a class="code" href="classMuseScore.html#r17">transportId</a>, <span class="keyword">false</span>);
00571             <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;setItemEnabled(<a class="code" href="classMuseScore.html#r10">playId</a>, <span class="keyword">false</span>);
00572             }
00573 
00574       <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;insertSeparator();
00575       <a class="code" href="classMuseScore.html#r11">visibleId</a> = <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;insertItem(tr(<span class="stringliteral">"Show Invisible"</span>), <a class="code" href="classMuseScore.html#r1">canvas</a>, SLOT(showInvisibleClicked()));
00576       <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;setItemChecked(<a class="code" href="classMuseScore.html#r11">visibleId</a>, <a class="code" href="element_8cpp.html#a1">showInvisible</a>);
00577       <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;setCheckable(<span class="keyword">true</span>);
00578 
00579       <span class="comment">//---------------------</span>
00580       <span class="comment">//    Menu Help</span>
00581       <span class="comment">//---------------------</span>
00582 
00583       menuBar()-&gt;insertSeparator();
00584       QMenu* menuHelp = <span class="keyword">new</span> QMenu(<span class="keyword">this</span>);
00585       mb-&gt;addMenu(menuHelp);
00586 
00587       menuHelp-&gt;setCheckable(<span class="keyword">false</span>);
00588       menuBar()-&gt;insertItem(tr(<span class="stringliteral">"&amp;Help"</span>), menuHelp);
00589 
00590       menuHelp-&gt;insertItem(tr(<span class="stringliteral">"Browser"</span>),  <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k0">helpBrowser</a>()), Qt::Key_F1);
00591       menuHelp-&gt;insertItem(tr(<span class="stringliteral">"&amp;About"</span>),   <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k1">about</a>()));
00592       menuHelp-&gt;insertItem(tr(<span class="stringliteral">"About&amp;Qt"</span>), <span class="keyword">this</span>, SLOT(<a class="code" href="classMuseScore.html#k2">aboutQt</a>()));
00593       menuHelp-&gt;insertSeparator();
00594       whatsThis-&gt;addTo(menuHelp);
00595 
00596       setCentralWidget(mainWindow);
00597       connect(<a class="code" href="classMuseScore.html#r7">mag</a>, SIGNAL(activated(<span class="keywordtype">int</span>)), SLOT(<a class="code" href="classMuseScore.html#k69">magChanged</a>(<span class="keywordtype">int</span>)));
00598       connect(<a class="code" href="classMuseScore.html#r1">canvas</a>, SIGNAL(<a class="code" href="classMuseScore.html#k69">magChanged</a>()), SLOT(<a class="code" href="classMuseScore.html#k7">updateMag</a>()));
00599 
00600       <a class="code" href="classMuseScore.html#d9">loadInstrumentTemplates</a>();
00601       <a class="code" href="classMuseScore.html#k14">preferencesChanged</a>();
00602       connect(<a class="code" href="seq_8cpp.html#a0">seq</a>, SIGNAL(started()), SLOT(<a class="code" href="classMuseScore.html#k33">seqStarted</a>()));
00603       connect(<a class="code" href="seq_8cpp.html#a0">seq</a>, SIGNAL(stopped()), SLOT(<a class="code" href="classMuseScore.html#k34">seqStopped</a>()));
00604       <a class="code" href="classMuseScore.html#d8">loadScoreList</a>();
00605       }
00606 
00607 <span class="comment">//---------------------------------------------------------</span>
00608 <span class="comment">//   toggleTransportToolbar</span>
00609 <span class="comment">//---------------------------------------------------------</span>
00610 
<a name="l00611"></a><a class="code" href="classMuseScore.html#k18">00611</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k18">MuseScore::toggleTransportToolbar</a>()
00612       {
00613       <span class="keywordtype">bool</span> flag = <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;isItemChecked(<a class="code" href="classMuseScore.html#r17">transportId</a>);
00614       <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;setItemChecked(<a class="code" href="classMuseScore.html#r17">transportId</a>, !flag);
00615       <a class="code" href="classMuseScore.html#r21">transportTools</a>-&gt;setShown(!flag);
00616       }
00617 
00618 <span class="comment">//---------------------------------------------------------</span>
00619 <span class="comment">//   toggleInputToolbar</span>
00620 <span class="comment">//---------------------------------------------------------</span>
00621 
<a name="l00622"></a><a class="code" href="classMuseScore.html#k19">00622</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k19">MuseScore::toggleInputToolbar</a>()
00623       {
00624       <span class="keywordtype">bool</span> flag = <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;isItemChecked(<a class="code" href="classMuseScore.html#r18">inputId</a>);
00625       <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;setItemChecked(<a class="code" href="classMuseScore.html#r18">inputId</a>, !flag);
00626       <a class="code" href="classMuseScore.html#r22">entryTools</a>-&gt;setShown(!flag);
00627       }
00628 
00629 <span class="comment">//---------------------------------------------------------</span>
00630 <span class="comment">//   setEntry</span>
00631 <span class="comment">//---------------------------------------------------------</span>
00632 
<a name="l00633"></a><a class="code" href="classMuseScore.html#k8">00633</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k8">MuseScore::setEntry</a>(<span class="keywordtype">bool</span> flag, <span class="keywordtype">int</span> i)
00634       {
00635       <span class="keywordflow">switch</span> (i) {
00636             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a0">PAD_NOTE1</a>:  <a class="code" href="classMuseScore.html#r12">entryTb</a>[0]-&gt;setOn(flag);  <span class="keywordflow">break</span>;
00637             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a1">PAD_NOTE2</a>:  <a class="code" href="classMuseScore.html#r12">entryTb</a>[1]-&gt;setOn(flag);  <span class="keywordflow">break</span>;
00638             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a2">PAD_NOTE4</a>:  <a class="code" href="classMuseScore.html#r12">entryTb</a>[2]-&gt;setOn(flag);  <span class="keywordflow">break</span>;
00639             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a3">PAD_NOTE8</a>:  <a class="code" href="classMuseScore.html#r12">entryTb</a>[3]-&gt;setOn(flag);  <span class="keywordflow">break</span>;
00640             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a4">PAD_NOTE16</a>: <a class="code" href="classMuseScore.html#r12">entryTb</a>[4]-&gt;setOn(flag);  <span class="keywordflow">break</span>;
00641             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a5">PAD_NOTE32</a>: <a class="code" href="classMuseScore.html#r12">entryTb</a>[5]-&gt;setOn(flag);  <span class="keywordflow">break</span>;
00642             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a6">PAD_NOTE64</a>: <a class="code" href="classMuseScore.html#r12">entryTb</a>[6]-&gt;setOn(flag);  <span class="keywordflow">break</span>;
00643             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a8">PAD_DOT</a>:    <a class="code" href="classMuseScore.html#r12">entryTb</a>[7]-&gt;setOn(flag);  <span class="keywordflow">break</span>;
00644             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a16">PAD_TIE</a>:    <a class="code" href="classMuseScore.html#r12">entryTb</a>[8]-&gt;setOn(flag);  <span class="keywordflow">break</span>; <span class="comment">//</span>
00645             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a7">PAD_REST</a>:   <a class="code" href="classMuseScore.html#r12">entryTb</a>[9]-&gt;setOn(flag);  <span class="keywordflow">break</span>;
00646             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a9">PAD_SHARP2</a>: <a class="code" href="classMuseScore.html#r12">entryTb</a>[10]-&gt;setOn(flag);  <span class="keywordflow">break</span>;
00647             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a10">PAD_SHARP</a>:  <a class="code" href="classMuseScore.html#r12">entryTb</a>[11]-&gt;setOn(flag); <span class="keywordflow">break</span>;
00648             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a11">PAD_NAT</a>:    <a class="code" href="classMuseScore.html#r12">entryTb</a>[12]-&gt;setOn(flag); <span class="keywordflow">break</span>;
00649             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a12">PAD_FLAT</a>:   <a class="code" href="classMuseScore.html#r12">entryTb</a>[13]-&gt;setOn(flag); <span class="keywordflow">break</span>;
00650             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a13">PAD_FLAT2</a>:  <a class="code" href="classMuseScore.html#r12">entryTb</a>[14]-&gt;setOn(flag); <span class="keywordflow">break</span>;
00651             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a25">PAD_VOICE0</a>: <a class="code" href="classMuseScore.html#r13">voiceTb</a>[0]-&gt;setOn(flag); <span class="keywordflow">break</span>;
00652             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a26">PAD_VOICE1</a>: <a class="code" href="classMuseScore.html#r13">voiceTb</a>[1]-&gt;setOn(flag); <span class="keywordflow">break</span>;
00653             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a27">PAD_VOICE2</a>: <a class="code" href="classMuseScore.html#r13">voiceTb</a>[2]-&gt;setOn(flag); <span class="keywordflow">break</span>;
00654             <span class="keywordflow">case</span> <a class="code" href="padids_8h.html#a29a28">PAD_VOICE3</a>: <a class="code" href="classMuseScore.html#r13">voiceTb</a>[3]-&gt;setOn(flag); <span class="keywordflow">break</span>;
00655             }
00656       }
00657 
00658 <span class="comment">//---------------------------------------------------------</span>
00659 <span class="comment">//   magChanged</span>
00660 <span class="comment">//---------------------------------------------------------</span>
00661 
<a name="l00662"></a><a class="code" href="classMuseScore.html#k69">00662</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k69">MuseScore::magChanged</a>(<span class="keywordtype">int</span> idx)
00663       {
00664       qreal <a class="code" href="classMuseScore.html#r7">mag</a> = <a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a19">mag</a>();
00665       QSizeF s = <a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a26">fsize</a>();
00666       <span class="keywordflow">switch</span>(idx) {
00667             <span class="keywordflow">case</span> 0:  mag = 0.25; <span class="keywordflow">break</span>;
00668             <span class="keywordflow">case</span> 1:  mag = 0.5;  <span class="keywordflow">break</span>;
00669             <span class="keywordflow">case</span> 2:  mag = 0.75; <span class="keywordflow">break</span>;
00670             <span class="keywordflow">case</span> 3:  mag = 1.0;  <span class="keywordflow">break</span>;
00671             <span class="keywordflow">case</span> 4:  mag = 1.5;  <span class="keywordflow">break</span>;
00672             <span class="keywordflow">case</span> 5:  mag = 2.0;  <span class="keywordflow">break</span>;
00673             <span class="keywordflow">case</span> 6:  mag = 4.0;  <span class="keywordflow">break</span>;
00674             <span class="keywordflow">case</span> 7:  mag = 8.0;  <span class="keywordflow">break</span>;
00675             <span class="keywordflow">case</span> 8:  mag = 16.0; <span class="keywordflow">break</span>;
00676             <span class="keywordflow">case</span> 9:      <span class="comment">// page width</span>
00677                   mag *= s.width() / <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a135">pageFormat</a>()-&gt;<a class="code" href="structPageFormat.html#a1">width</a>();
00678                   <a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a25">setOffset</a>(0.0, 0.0);
00679                   <span class="keywordflow">break</span>;
00680             <span class="keywordflow">case</span> 10:     <span class="comment">// page</span>
00681                   {
00682                   <span class="keywordtype">double</span> mag1 = s.width()  / <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a135">pageFormat</a>()-&gt;<a class="code" href="structPageFormat.html#a1">width</a>();
00683                   <span class="keywordtype">double</span> mag2 = s.height() / <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a135">pageFormat</a>()-&gt;<a class="code" href="structPageFormat.html#a2">height</a>();
00684                   mag  *= (mag1 &gt; mag2) ? mag2 : mag1;
00685                   <a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a25">setOffset</a>(0.0, 0.0);
00686                   }
00687                   <span class="keywordflow">break</span>;
00688             <span class="keywordflow">case</span> 11:    <span class="comment">// double page</span>
00689                   {
00690                   <span class="keywordtype">double</span> mag1 = s.width() / (<a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a135">pageFormat</a>()-&gt;<a class="code" href="structPageFormat.html#a1">width</a>()*2+50.0);
00691                   <span class="keywordtype">double</span> mag2 = s.height() / <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a135">pageFormat</a>()-&gt;<a class="code" href="structPageFormat.html#a2">height</a>();
00692                   mag  *= (mag1 &gt; mag2) ? mag2 : mag1;
00693                   <a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a25">setOffset</a>(0.0, 0.0);
00694                   }
00695                   <span class="keywordflow">break</span>;
00696             <span class="keywordflow">case</span> 12:    <span class="comment">// original size</span>
00697                   <span class="keywordflow">break</span>;
00698             }
00699       <a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a22">setMag</a>(mag);
00700       <a class="code" href="classMuseScore.html#k7">updateMag</a>();
00701       }
00702 
00703 <span class="comment">//---------------------------------------------------------</span>
00704 <span class="comment">//   updateMag</span>
00705 <span class="comment">//---------------------------------------------------------</span>
00706 
<a name="l00707"></a><a class="code" href="classMuseScore.html#k7">00707</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k7">MuseScore::updateMag</a>()
00708       {
00709       qreal val = <a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a19">mag</a>();
00710       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
00711             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a116">setMag</a>(val);
00712       QString s;
00713       s.setNum(val * 100, <span class="charliteral">'f'</span>, 1);
00714       s += <span class="stringliteral">"%"</span>;
00715       <a class="code" href="classMuseScore.html#r7">mag</a>-&gt;setEditText(s);
00716       }
00717 
00718 <span class="comment">//---------------------------------------------------------</span>
00719 <span class="comment">//   padVisible</span>
00720 <span class="comment">//---------------------------------------------------------</span>
00721 
<a name="l00722"></a><a class="code" href="classMuseScore.html#k3">00722</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k3">MuseScore::padVisible</a>(<span class="keywordtype">bool</span> flag)
00723       {
00724       <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;setItemChecked(<a class="code" href="classMuseScore.html#r9">padId</a>, flag);
00725       }
00726 
00727 <span class="comment">//---------------------------------------------------------</span>
00728 <span class="comment">//   playVisible</span>
00729 <span class="comment">//---------------------------------------------------------</span>
00730 
<a name="l00731"></a><a class="code" href="classMuseScore.html#d2">00731</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#d2">MuseScore::playVisible</a>(<span class="keywordtype">bool</span> flag)
00732       {
00733       <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;setItemChecked(<a class="code" href="classMuseScore.html#r10">playId</a>, flag);
00734       }
00735 
00736 <span class="comment">//---------------------------------------------------------</span>
00737 <span class="comment">//   helpBrowser</span>
00738 <span class="comment">//---------------------------------------------------------</span>
00739 
<a name="l00740"></a><a class="code" href="classMuseScore.html#k0">00740</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k0">MuseScore::helpBrowser</a>()
00741       {
00742       QString lang(getenv(<span class="stringliteral">"LANG"</span>));
00743       QString mscoreHelp = <a class="code" href="mscore_8cpp.html#a0">mscoreGlobalShare</a> + QString(<span class="stringliteral">"/html/"</span>) + lang + QString(<span class="stringliteral">"/index.html"</span>);
00744       <span class="keywordflow">if</span> (access(mscoreHelp.latin1(), R_OK)) {
00745               mscoreHelp = <a class="code" href="mscore_8cpp.html#a0">mscoreGlobalShare</a> + QString(<span class="stringliteral">"/html/index.html"</span>);
00746             <span class="keywordflow">if</span> (access(mscoreHelp.latin1(), R_OK) != 0) {
00747                   QString info(tr(<span class="stringliteral">"no help found at: "</span>));
00748                   info += mscoreHelp;
00749                   QMessageBox::critical(<span class="keyword">this</span>, tr(<span class="stringliteral">"MuseScore: Open Help"</span>), info);
00750                   <span class="keywordflow">return</span>;
00751                   }
00752             }
00753       <a class="code" href="classMuseScore.html#d3">launchBrowser</a>(QString(<span class="stringliteral">"file://"</span>) + mscoreHelp);
00754       }
00755 
00756 <span class="comment">//---------------------------------------------------------</span>
00757 <span class="comment">//   launchBrowser</span>
00758 <span class="comment">//---------------------------------------------------------</span>
00759 
<a name="l00760"></a><a class="code" href="classMuseScore.html#d3">00760</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#d3">MuseScore::launchBrowser</a>(<span class="keyword">const</span> QString whereTo)
00761       {
00762       <span class="keywordtype">char</span> testStr[40];
00763       strcpy(testStr, <span class="stringliteral">"which "</span>);
00764       strcat(testStr, <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o1">browseCmd</a>.latin1());
00765       <span class="keywordflow">if</span> (<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o1">browseCmd</a>.isEmpty() || system(testStr)) {
00766             QMessageBox::information( <span class="keyword">this</span>, <span class="stringliteral">"Unable to launch help"</span>,
00767                <span class="stringliteral">"For some reason MuseScore has failed to detect or launch\n"</span>
00768                <span class="stringliteral">"a browser on your machine. Please go to File-&gt;Preferences-&gt;HelperApps\n"</span>
00769                <span class="stringliteral">"and insert the program name of your favourite browser."</span>,
00770                <span class="stringliteral">"Ok"</span>,
00771                0 );
00772             <span class="keywordflow">return</span>;
00773             }
00774 
00775       QString exe(<span class="stringliteral">"/bin/sh"</span>);
00776       <span class="keywordflow">if</span> (QFile::exists(exe)) {
00777             Q3Process helper(<span class="keyword">this</span>);
00778             helper.addArgument(exe);
00779             helper.addArgument(<span class="stringliteral">"-c"</span>);
00780             helper.addArgument(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o1">browseCmd</a> + <span class="stringliteral">" "</span> + whereTo);
00781             helper.start();
00782             }
00783       <span class="keywordflow">else</span> {
00784             printf(<span class="stringliteral">"Unable to launch help\n"</span>);
00785             }
00786       }
00787 
00788 <span class="comment">//---------------------------------------------------------</span>
00789 <span class="comment">//   about</span>
00790 <span class="comment">//---------------------------------------------------------</span>
00791 
<a name="l00792"></a><a class="code" href="classMuseScore.html#k1">00792</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k1">MuseScore::about</a>()
00793       {
00794       QMessageBox* mb = <span class="keyword">new</span> QMessageBox();
00795       mb-&gt;setCaption(QString(<span class="stringliteral">"MuseScore"</span>));
00796       mb-&gt;setText(tr(<span class="stringliteral">"Linux Music Score Editor\n"</span>
00797        <span class="stringliteral">"Version "</span> <a class="code" href="config_8h.html#a20">VERSION</a> <span class="stringliteral">"\n"</span>
00798        <span class="stringliteral">"(C) Copyright 2002-2003 Werner Schweer\n"</span>
00799        <span class="stringliteral">"see http://mscore.sourceforge.net/ for new versions\n"</span>
00800        <span class="stringliteral">"and more information\n"</span>
00801        <span class="stringliteral">"Published under the GNU Public Licence"</span>));
00802 <span class="comment">//      mb-&gt;setIconPixmap(QPixmap("muse1.png"));</span>
00803       mb-&gt;exec();
00804       }
00805 
00806 <span class="comment">//---------------------------------------------------------</span>
00807 <span class="comment">//   aboutQt</span>
00808 <span class="comment">//---------------------------------------------------------</span>
00809 
<a name="l00810"></a><a class="code" href="classMuseScore.html#k2">00810</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k2">MuseScore::aboutQt</a>()
00811       {
00812       QMessageBox::aboutQt(<span class="keyword">this</span>, QString(<span class="stringliteral">"MuseScore"</span>));
00813       }
00814 
00815 <span class="comment">//---------------------------------------------------------</span>
00816 <span class="comment">//   openRecentMenu</span>
00817 <span class="comment">//---------------------------------------------------------</span>
00818 
<a name="l00819"></a><a class="code" href="classMuseScore.html#k4">00819</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k4">MuseScore::openRecentMenu</a>()
00820       {
00821       <a class="code" href="classMuseScore.html#d6">genRecentPopup</a>(<a class="code" href="classMuseScore.html#r6">openRecent</a>);
00822       }
00823 
00824 <span class="comment">//---------------------------------------------------------</span>
00825 <span class="comment">//   selectScore</span>
00826 <span class="comment">//---------------------------------------------------------</span>
00827 
<a name="l00828"></a><a class="code" href="classMuseScore.html#k5">00828</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k5">MuseScore::selectScore</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)
00829       {
00830       <span class="keywordflow">if</span> (<span class="keywordtype">id</span> &lt; 0)
00831             <span class="keywordflow">return</span>;
00832       QString project = <a class="code" href="classMuseScore.html#a9">getScore</a>(<span class="keywordtype">id</span>).mid(2);
00833       <span class="keywordflow">if</span> (project.isEmpty())
00834             <span class="keywordflow">return</span>;
00835       <a class="code" href="classMuseScore.html#d1">loadScoreFile</a>(project);
00836       }
00837 
<a name="l00838"></a><a class="code" href="classMuseScore.html#d1">00838</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#d1">MuseScore::loadScoreFile</a>(<span class="keyword">const</span> QString&amp;)
00839       {
00840       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#a2">checkDirty</a>())
00841             <span class="keywordflow">return</span>;
00842 printf(<span class="stringliteral">"TODO      loadFile(s, false);\n"</span>);
00843       }
00844 
00845 <span class="comment">//---------------------------------------------------------</span>
00846 <span class="comment">//   selectionChanged</span>
00847 <span class="comment">//---------------------------------------------------------</span>
00848 
<a name="l00849"></a><a class="code" href="classMuseScore.html#k9">00849</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k9">MuseScore::selectionChanged</a>(<span class="keywordtype">int</span> state)
00850       {
00851       <a class="code" href="classMuseScore.html#r5">menuEdit</a>-&gt;setItemEnabled(<a class="code" href="classMuseScore.html#r14">cutId</a>, state);
00852       <a class="code" href="classMuseScore.html#r5">menuEdit</a>-&gt;setItemEnabled(<a class="code" href="classMuseScore.html#r15">copyId</a>, state);
00853       <a class="code" href="classMuseScore.html#r5">menuEdit</a>-&gt;setItemEnabled(<a class="code" href="classMuseScore.html#r16">pasteId</a>, state);
00854       }
00855 
00856 <span class="comment">//---------------------------------------------------------</span>
00857 <span class="comment">//   showInvisibleChanged</span>
00858 <span class="comment">//---------------------------------------------------------</span>
00859 
<a name="l00860"></a><a class="code" href="classMuseScore.html#k15">00860</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k15">MuseScore::showInvisibleChanged</a>()
00861       {
00862       <a class="code" href="classMuseScore.html#r4">menuDisplay</a>-&gt;setItemChecked(<a class="code" href="classMuseScore.html#r11">visibleId</a>, <a class="code" href="element_8cpp.html#a1">showInvisible</a>);
00863       }
00864 
00865 <span class="comment">//---------------------------------------------------------</span>
00866 <span class="comment">//   appendScore</span>
00867 <span class="comment">//---------------------------------------------------------</span>
00868 
<a name="l00869"></a><a class="code" href="classMuseScore.html#a8">00869</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#a8">MuseScore::appendScore</a>(<a class="code" href="classScore.html">Score</a>* score)
00870       {
00871       <a class="code" href="classMuseScore.html#r43">scoreList</a>.push_back(score);
00872       <a class="code" href="classMuseScore.html#r3">tab</a>-&gt;addTab(score-&gt;<a class="code" href="classScore.html#o1">projectName</a>);
00873 
00874       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r43">scoreList</a>.size() &gt; 1)
00875             <a class="code" href="classMuseScore.html#r3">tab</a>-&gt;show();
00876       <span class="keywordflow">else</span>
00877             <a class="code" href="classMuseScore.html#r3">tab</a>-&gt;hide();
00878 
00879       QString name(score-&gt;<a class="code" href="classScore.html#o1">projectName</a>);
00880       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; PROJECT_LIST_LEN; ++i) {
00881             <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#v0">projectList</a>[i] == 0)
00882                   <span class="keywordflow">break</span>;
00883             <span class="keywordflow">if</span> (name == (*<a class="code" href="classMuseScore.html#v0">projectList</a>[i]).mid(2)) {
00884                   <span class="keywordtype">int</span> dst = i;
00885                   <span class="keywordtype">int</span> src = i+1;
00886                   <span class="keywordtype">int</span> n   = PROJECT_LIST_LEN - i - 1;
00887                   <span class="keyword">delete</span> projectList[i];
00888                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; n; ++k)
00889                         projectList[dst++] = projectList[src++];
00890                   projectList[dst] = 0;
00891                   <span class="keywordflow">break</span>;
00892                   }
00893             }
00894       QString** s = &amp;<a class="code" href="classMuseScore.html#v0">projectList</a>[PROJECT_LIST_LEN - 2];
00895       QString** d = &amp;projectList[PROJECT_LIST_LEN - 1];
00896       <span class="keywordflow">if</span> (*d)
00897             <span class="keyword">delete</span> *d;
00898       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; PROJECT_LIST_LEN-1; ++i)
00899             *d-- = *s--;
00900       projectList[0] = <span class="keyword">new</span> QString(<span class="stringliteral">"  "</span> + name);
00901       }
00902 
00903 <span class="comment">//---------------------------------------------------------</span>
00904 <span class="comment">//   usage</span>
00905 <span class="comment">//---------------------------------------------------------</span>
00906 
<a name="l00907"></a><a class="code" href="mscore_8cpp.html#a18">00907</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mscore_8cpp.html#a18">usage</a>(<span class="keyword">const</span> <span class="keywordtype">char</span>* prog, <span class="keyword">const</span> <span class="keywordtype">char</span>* txt)
00908       {
00909       fprintf(stderr, <span class="stringliteral">"%s: %s\nusage: %s flags scorefile\n   Flags:\n"</span>,
00910          prog, txt, prog);
00911       fprintf(stderr, <span class="stringliteral">"   -v        print version\n"</span>);
00912       fprintf(stderr, <span class="stringliteral">"   -d        debug mode\n"</span>);
00913       fprintf(stderr, <span class="stringliteral">"   -R file   record gui events into file\n"</span>);
00914       fprintf(stderr, <span class="stringliteral">"   -P file   replay gui events from file\n"</span>);
00915       fprintf(stderr, <span class="stringliteral">"   -s        no internal synthesizer\n"</span>);
00916       fprintf(stderr, <span class="stringliteral">"   -m        no midi\n"</span>);
00917       fprintf(stderr, <span class="stringliteral">"   -L        layout debug\n"</span>);
00918       }
00919 
00920 <span class="comment">//---------------------------------------------------------</span>
00921 <span class="comment">//   signalHandler</span>
00922 <span class="comment">//---------------------------------------------------------</span>
00923 
<a name="l00924"></a><a class="code" href="mscore_8cpp.html#a19">00924</a> <span class="keyword">static</span> <span class="keywordtype">void</span> <a class="code" href="mscore_8cpp.html#a19">signalHandler</a>(<span class="keywordtype">int</span>)
00925       {
00926       printf(<span class="stringliteral">"signal SIGFPE\n"</span>);
00927       abort();
00928       }
00929 
00930 <span class="comment">//---------------------------------------------------------</span>
00931 <span class="comment">//   editTextStyle</span>
00932 <span class="comment">//---------------------------------------------------------</span>
00933 
<a name="l00934"></a><a class="code" href="classMuseScore.html#k32">00934</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k32">MuseScore::editTextStyle</a>()
00935       {
00936       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r26">textStyleDialog</a> == 0) {
00937             <a class="code" href="classMuseScore.html#r26">textStyleDialog</a> = <span class="keyword">new</span> <a class="code" href="classTextStyleDialog.html">TextStyleDialog</a>(<span class="keyword">this</span>, <span class="stringliteral">"textStyleDialog"</span>);
00938             connect(<a class="code" href="classMuseScore.html#r26">textStyleDialog</a>, SIGNAL(textStyleChanged()), <a class="code" href="classMuseScore.html#r1">canvas</a>, SLOT(textStyleChanged()));
00939             }
00940       <a class="code" href="classMuseScore.html#r26">textStyleDialog</a>-&gt;show();
00941       }
00942 
00943 <span class="comment">//---------------------------------------------------------</span>
00944 <span class="comment">//   saveScoreList</span>
00945 <span class="comment">//---------------------------------------------------------</span>
00946 
<a name="l00947"></a><a class="code" href="classMuseScore.html#d7">00947</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#d7">MuseScore::saveScoreList</a>()
00948       {
00949       QString prjPath(getenv(<span class="stringliteral">"HOME"</span>));
00950       prjPath += <span class="stringliteral">"/.mscorePrj"</span>;
00951       FILE* f = fopen(prjPath.latin1(), <span class="stringliteral">"w"</span>);
00952       <span class="keywordflow">if</span> (f) {
00953             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; PROJECT_LIST_LEN; ++i) {
00954                   <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#v0">projectList</a>[i]) {
00955                         <span class="keywordtype">bool</span> loaded = <span class="keyword">false</span>;
00956                         <span class="keywordflow">for</span> (std::vector&lt;Score*&gt;::iterator k = <a class="code" href="classMuseScore.html#r43">scoreList</a>.begin(); k != <a class="code" href="classMuseScore.html#r43">scoreList</a>.end(); ++k) {
00957                               <span class="keywordflow">if</span> ((*k)-&gt;projectName == (*<a class="code" href="classMuseScore.html#v0">projectList</a>[i]).mid(2)) {
00958                                     loaded = <span class="keyword">true</span>;
00959                                     <span class="keywordflow">break</span>;
00960                                     }
00961                               }
00962                         fprintf(f, <span class="stringliteral">"%c %s\n"</span>,
00963                            loaded ? <span class="charliteral">'*'</span> : <span class="charliteral">' '</span>, <a class="code" href="classMuseScore.html#v0">projectList</a>[i]-&gt;mid(2).latin1());
00964                         }
00965                   <span class="keywordflow">else</span>
00966                         fprintf(f, <span class="stringliteral">"\n"</span>);
00967                   }
00968             fclose(f);
00969             }
00970       }
00971 
00972 <span class="comment">//---------------------------------------------------------</span>
00973 <span class="comment">//   loadScoreList</span>
00974 <span class="comment">//    read list of "Recent Scores"</span>
00975 <span class="comment">//---------------------------------------------------------</span>
00976 
<a name="l00977"></a><a class="code" href="classMuseScore.html#d8">00977</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#d8">MuseScore::loadScoreList</a>()
00978       {
00979       QString prjPath(getenv(<span class="stringliteral">"HOME"</span>));
00980       prjPath += QString(<span class="stringliteral">"/.mscorePrj"</span>);
00981       FILE* f = fopen(prjPath.latin1(), <span class="stringliteral">"r"</span>);
00982       <span class="keywordflow">if</span> (f) {
00983             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; PROJECT_LIST_LEN; ++i) {
00984                   <span class="keywordtype">char</span> buffer[512];
00985                   <span class="keywordflow">if</span> (fgets(buffer, 512, f)) {
00986                         <span class="keywordtype">int</span> n = strlen(buffer);
00987                         <span class="keywordflow">if</span> (n &amp;&amp; buffer[n-1] == <span class="charliteral">'\n'</span>)
00988                               buffer[n-1] = 0;
00989                         <a class="code" href="classMuseScore.html#v0">projectList</a>[i] = *buffer ? <span class="keyword">new</span> QString(buffer) : 0;
00990                         }
00991                   <span class="keywordflow">else</span>
00992                         <span class="keywordflow">break</span>;
00993                   }
00994             fclose(f);
00995             }
00996       }
00997 
00998 <span class="comment">//---------------------------------------------------------</span>
00999 <span class="comment">//   genRecentPopup</span>
01000 <span class="comment">//---------------------------------------------------------</span>
01001 
<a name="l01002"></a><a class="code" href="classMuseScore.html#d6">01002</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#d6">MuseScore::genRecentPopup</a>(QMenu* popup)<span class="keyword"> const</span>
01003 <span class="keyword">      </span>{
01004       popup-&gt;clear();
01005       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; PROJECT_LIST_LEN; ++i) {
01006             <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#v0">projectList</a>[i] == 0)
01007                   <span class="keywordflow">break</span>;
01008             <span class="keyword">const</span> <span class="keywordtype">char</span>* path = <a class="code" href="classMuseScore.html#v0">projectList</a>[i]-&gt;latin1() + 2;
01009             <span class="keyword">const</span> <span class="keywordtype">char</span>* p = strrchr(path, <span class="charliteral">'/'</span>);
01010             <span class="keywordflow">if</span> (p == 0)
01011                   p = path;
01012             <span class="keywordflow">else</span>
01013                   ++p;
01014             popup-&gt;insertItem(QString(p), i);
01015             }
01016       }
01017 
01018 <span class="comment">//---------------------------------------------------------</span>
01019 <span class="comment">//   getTopScore</span>
01020 <span class="comment">//---------------------------------------------------------</span>
01021 
<a name="l01022"></a><a class="code" href="classMuseScore.html#a9">01022</a> QString <a class="code" href="classMuseScore.html#a9">MuseScore::getScore</a>(<span class="keywordtype">int</span> idx)<span class="keyword"> const</span>
01023 <span class="keyword">      </span>{
01024       <span class="keywordflow">if</span> (idx &gt;= PROJECT_LIST_LEN)
01025             idx = PROJECT_LIST_LEN - 1;
01026       <span class="keyword">static</span> QString empty(<span class="stringliteral">"  "</span>);
01027       <span class="keywordflow">return</span> <a class="code" href="classMuseScore.html#v0">projectList</a>[idx] ? *<a class="code" href="classMuseScore.html#v0">projectList</a>[idx] : empty;
01028       }
01029 
01030 <span class="comment">//---------------------------------------------------------</span>
01031 <span class="comment">//   setCurrentScore</span>
01032 <span class="comment">//---------------------------------------------------------</span>
01033 
<a name="l01034"></a><a class="code" href="classMuseScore.html#i0">01034</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#i0">MuseScore::setCurrentScore</a>(<span class="keywordtype">int</span> idx)
01035       {
01036       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>) {
01037             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;disconnect(SIGNAL(padChanged(<span class="keywordtype">bool</span>,<span class="keywordtype">int</span>)), <span class="keyword">this</span>);
01038             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;disconnect(SIGNAL(<a class="code" href="classMuseScore.html#k9">selectionChanged</a>(<span class="keywordtype">int</span>)), <span class="keyword">this</span>);
01039             <span class="comment">//</span>
01040             <span class="comment">// remember "global" values:</span>
01041             <span class="comment">//</span>
01042             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a116">setMag</a>(<a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a19">mag</a>());
01043             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a119">setXoffset</a>(<a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a20">xoffset</a>());
01044             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a120">setYoffset</a>(<a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a21">yoffset</a>());
01045             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a113">setSpatium</a>(<a class="code" href="spatium_8h.html#a0">_spatium</a>);
01046             }
01047 
01048       <a class="code" href="classMuseScore.html#r0">cs</a> = <a class="code" href="classMuseScore.html#r43">scoreList</a>[idx];
01049       <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a30">clearViewer</a>();
01050       <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a29">addViewer</a>(<a class="code" href="classMuseScore.html#r1">canvas</a>);
01051       <a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a17">setScore</a>(<a class="code" href="classMuseScore.html#r0">cs</a>);
01052       <a class="code" href="seq_8cpp.html#a0">seq</a>-&gt;<a class="code" href="classSeq.html#a17">setScore</a>(<a class="code" href="classMuseScore.html#r0">cs</a>);
01053 
01054       <a class="code" href="spatium_8h.html#a0">_spatium</a>      = <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a114">spatium</a>();
01055       <a class="code" href="element_8cpp.html#a1">showInvisible</a> = <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a121">showInvisible</a>();
01056 
01057       <a class="code" href="mscore_8cpp.html#a11">undoAction</a>-&gt;setEnabled(!<a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a133">undoEmpty</a>());
01058       <a class="code" href="mscore_8cpp.html#a12">redoAction</a>-&gt;setEnabled(!<a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a134">redoEmpty</a>());
01059 
01060       <a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a22">setMag</a>(<a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a115">mag</a>());
01061       <a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a23">setXoffset</a>(<a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a117">xoffset</a>());
01062       <a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a24">setYoffset</a>(<a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a118">yoffset</a>());
01063 
01064       <a class="code" href="classMuseScore.html#k71">pageSettingsChanged</a>();
01065 
01066       emit <a class="code" href="classMuseScore.html#k15">showInvisibleChanged</a>();
01067 
01068       <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a85">setUpdateAll</a>();
01069       <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a84">endCmd</a>(<span class="keyword">false</span>);
01070       <a class="code" href="project_8cpp.html#a2">mscore</a>-&gt;setCaption(<span class="stringliteral">"MuseScore: "</span> + <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#o1">projectName</a>);
01071       <a class="code" href="classMuseScore.html#k7">updateMag</a>();
01072       connect(<a class="code" href="classMuseScore.html#r0">cs</a>, SIGNAL(padChanged(<span class="keywordtype">bool</span>,<span class="keywordtype">int</span>)), SLOT(<a class="code" href="classMuseScore.html#k8">setEntry</a>(<span class="keywordtype">bool</span>,<span class="keywordtype">int</span>)));
01073       connect(<a class="code" href="classMuseScore.html#r0">cs</a>, SIGNAL(<a class="code" href="classMuseScore.html#k9">selectionChanged</a>(<span class="keywordtype">int</span>)), SLOT(<a class="code" href="classMuseScore.html#k9">selectionChanged</a>(<span class="keywordtype">int</span>)));
01074       QCoreApplication::processEvents(QEventLoop::AllEvents, 500);
01075       }
01076 
01077 <span class="comment">//---------------------------------------------------------</span>
01078 <span class="comment">//   main</span>
01079 <span class="comment">//---------------------------------------------------------</span>
01080 
<a name="l01081"></a><a class="code" href="mscore_8cpp.html#a20">01081</a> <span class="keywordtype">int</span> <a class="code" href="mscore_8cpp.html#a20">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])
01082       {
01083 <span class="comment">//      feenableexcept(FE_DIVBYZERO | FE_INVALID | FE_OVERFLOW);</span>
01084 <span class="comment">//      signal(SIGFPE, signalHandler);</span>
01085 
01086       <a class="code" href="style_8cpp.html#a7">setDefaultStyle</a>();
01087       <a class="code" href="app_8h.html#a0">app</a>     = <span class="keyword">new</span> <a class="code" href="classMscoreApplication.html">MscoreApplication</a>(argc, argv);
01088       <a class="code" href="globals_8h.html#a5">appDpiX</a> = <a class="code" href="mscore_8cpp.html#a15">QX11Info::appDpiX</a>();
01089       <a class="code" href="globals_8h.html#a6">appDpiY</a> = <a class="code" href="mscore_8cpp.html#a16">QX11Info::appDpiY</a>();
01090 
01091       <span class="keywordtype">int</span> c;
01092       <span class="keywordflow">while</span> ((c = getopt(argc, argv, <span class="stringliteral">"vdLsm"</span>)) != EOF) {
01093             <span class="keywordflow">switch</span> (c) {
01094                   <span class="keywordflow">case</span> <span class="charliteral">'v'</span>:
01095                         <a class="code" href="mscore_8cpp.html#a17">printVersion</a>(argv[0]);
01096                         <span class="keywordflow">return</span> 0;
01097                   <span class="keywordflow">case</span> <span class="charliteral">'d'</span>:
01098                         <a class="code" href="element_8cpp.html#a0">debugMode</a> = <span class="keyword">true</span>;
01099                         <span class="keywordflow">break</span>;
01100                   <span class="keywordflow">case</span> <span class="charliteral">'L'</span>:
01101                         <a class="code" href="project_8cpp.html#a4">layoutDebug</a> = <span class="keyword">true</span>;
01102                         <span class="keywordflow">break</span>;
01103                   <span class="keywordflow">case</span> <span class="charliteral">'s'</span>:
01104                         <a class="code" href="project_8cpp.html#a5">noSeq</a> = <span class="keyword">true</span>;
01105                         <span class="keywordflow">break</span>;
01106                   <span class="keywordflow">case</span> <span class="charliteral">'m'</span>:
01107                         <a class="code" href="project_8cpp.html#a6">noMidi</a> = <span class="keyword">true</span>;
01108                         <span class="keywordflow">break</span>;
01109                   <span class="keywordflow">default</span>:
01110                         <a class="code" href="mscore_8cpp.html#a18">usage</a>(argv[0], <span class="stringliteral">"bad argument"</span>);
01111                         <span class="keywordflow">return</span> -1;
01112                   }
01113             }
01114       argc -= optind;
01115       ++argc;
01116 
01117       <a class="code" href="mscore_8cpp.html#a14">haveMidi</a> = !<a class="code" href="alsa_8cpp.html#a0">initMidi</a>();
01118       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#a2">read</a>();
01119 
01120       <span class="keywordflow">if</span> (<a class="code" href="element_8cpp.html#a0">debugMode</a>) {
01121             <span class="keywordflow">if</span> (<a class="code" href="mscore_8cpp.html#a14">haveMidi</a>)
01122                   printf(<span class="stringliteral">"midi devices found\n"</span>);
01123             }
01124 
01125       QString mscoreGlobal = getenv(<span class="stringliteral">"MSCORE"</span>);
01126       <span class="keywordflow">if</span> (mscoreGlobal.isEmpty()) {
01127             QString mscoreGlobal(INSTPREFIX);
01128             <a class="code" href="mscore_8cpp.html#a0">mscoreGlobalShare</a> = mscoreGlobal + <span class="stringliteral">"/share/mscore"</span>;
01129             }
01130       <span class="keywordflow">else</span> {
01131             <a class="code" href="mscore_8cpp.html#a0">mscoreGlobalShare</a> = mscoreGlobal + <span class="stringliteral">"/share"</span>;
01132             }
01133 
01134       <span class="keyword">static</span> QTranslator translator(0);
01135       QString lo = QTextCodec::locale();
01136       <span class="keywordflow">if</span> (lo != <span class="stringliteral">"C"</span>) {
01137             QString loc(<span class="stringliteral">"mscore_"</span>);
01138             loc += lo;
01139             <span class="keywordflow">if</span> (translator.load(loc, QString(<span class="stringliteral">"."</span>)) == <span class="keyword">false</span>) {
01140                   QString lp(<a class="code" href="mscore_8cpp.html#a0">mscoreGlobalShare</a>);
01141                   lp += QString(<span class="stringliteral">"/locale"</span>);
01142                   <span class="keywordflow">if</span> (translator.load(loc, lp) == <span class="keyword">false</span>) {
01143                         printf(<span class="stringliteral">"no locale &lt;%s&gt; in &lt;%s&gt;\n"</span>, loc.latin1(), lp.latin1());
01144                         }
01145                   <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="element_8cpp.html#a0">debugMode</a>)
01146                         printf(<span class="stringliteral">"locale %s from %s loaded\n"</span>,
01147                            loc.latin1(), lp.latin1());
01148                   }
01149             <a class="code" href="app_8h.html#a0">app</a>-&gt;installTranslator(&amp;translator);
01150             }
01151 
01152       <a class="code" href="seq_8cpp.html#a0">seq</a> = <span class="keyword">new</span> <a class="code" href="classSeq.html">Seq</a>();
01153       <span class="keywordflow">if</span> (!<a class="code" href="project_8cpp.html#a5">noSeq</a>) {
01154             <span class="keywordflow">if</span> (<a class="code" href="seq_8cpp.html#a0">seq</a>-&gt;<a class="code" href="classSeq.html#a3">init</a>()) {
01155                   printf(<span class="stringliteral">"sequencer init failed\n"</span>);
01156                   <a class="code" href="project_8cpp.html#a5">noSeq</a> = <span class="keyword">true</span>;
01157                   }
01158             }
01159 
01160       <span class="comment">//-------------------------------</span>
01161       <span class="comment">//  load scores</span>
01162       <span class="comment">//-------------------------------</span>
01163 
01164       <a class="code" href="icons_8cpp.html#a21">genIcons</a>();
01165       <a class="code" href="project_8cpp.html#a2">mscore</a> = <span class="keyword">new</span> <a class="code" href="classMuseScore.html">MuseScore</a>();
01166 
01167       <span class="keywordflow">if</span> (argc &lt; 2) {
01168             <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; PROJECT_LIST_LEN; ++i) {
01169                   QString s = <a class="code" href="project_8cpp.html#a2">mscore</a>-&gt;<a class="code" href="classMuseScore.html#a9">getScore</a>(i);
01170                   <span class="keywordflow">if</span> (s[0] != <span class="charliteral">'*'</span>) {
01171                         <span class="keywordflow">if</span> (i == 0) {
01172                               <span class="comment">// start with empty score:</span>
01173                               <a class="code" href="project_8cpp.html#a2">mscore</a>-&gt;<a class="code" href="classMuseScore.html#a8">appendScore</a>(<span class="keyword">new</span> <a class="code" href="classScore.html">Score</a>());
01174                               }
01175                         <span class="keywordflow">break</span>;
01176                         }
01177                   <a class="code" href="classScore.html">Score</a>* score = <span class="keyword">new</span> <a class="code" href="classScore.html">Score</a>();
01178                   score-&gt;<a class="code" href="classScore.html#a112">read</a>(s.mid(2));
01179                   <a class="code" href="project_8cpp.html#a2">mscore</a>-&gt;<a class="code" href="classMuseScore.html#a8">appendScore</a>(score);
01180                   }
01181             }
01182       <span class="keywordflow">else</span> {
01183             <span class="keywordflow">while</span> (argc &gt; 1) {
01184                   QString name = argv[optind++];
01185                   --argc;
01186                   <span class="keywordflow">if</span> (!name.isEmpty()) {
01187                         <a class="code" href="classScore.html">Score</a>* score = <span class="keyword">new</span> <a class="code" href="classScore.html">Score</a>();
01188                         score-&gt;<a class="code" href="classScore.html#a112">read</a>(name);
01189                         <a class="code" href="project_8cpp.html#a2">mscore</a>-&gt;<a class="code" href="classMuseScore.html#a8">appendScore</a>(score);
01190                         }
01191                   }
01192             }
01193       <a class="code" href="project_8cpp.html#a2">mscore</a>-&gt;resize(<a class="code" href="project_8h.html#a1">scoreSize</a>);
01194       <a class="code" href="project_8cpp.html#a2">mscore</a>-&gt;move(<a class="code" href="project_8h.html#a0">scorePos</a>);
01195       <a class="code" href="project_8cpp.html#a2">mscore</a>-&gt;<a class="code" href="classMuseScore.html#i0">setCurrentScore</a>(0);
01196 
01197       <span class="keywordtype">int</span> rfd = <a class="code" href="alsa_8cpp.html#a1">getMidiReadFd</a>();
01198       <span class="keywordflow">if</span> (<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o10">enableMidiInput</a> &amp;&amp; rfd != -1) {
01199             QSocketNotifier* sn = <span class="keyword">new</span> QSocketNotifier(rfd,
01200                QSocketNotifier::Read,  <a class="code" href="project_8cpp.html#a2">mscore</a>);
01201             sn-&gt;connect(sn, SIGNAL(activated(<span class="keywordtype">int</span>)), <a class="code" href="project_8cpp.html#a2">mscore</a>, SLOT(midiReceived()));
01202             }
01203 
01204       <a class="code" href="project_8cpp.html#a2">mscore</a>-&gt;show();
01205       <span class="keywordflow">return</span> <a class="code" href="app_8h.html#a0">app</a>-&gt;exec();
01206       }
01207 
01208 <span class="comment">//---------------------------------------------------------</span>
01209 <span class="comment">//   doRedo</span>
01210 <span class="comment">//---------------------------------------------------------</span>
01211 
<a name="l01212"></a><a class="code" href="classMuseScore.html#k46">01212</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k46">MuseScore::doRedo</a>()
01213       {
01214       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01215             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i9">doRedo</a>();
01216       }
01217 
01218 <span class="comment">//---------------------------------------------------------</span>
01219 <span class="comment">//   doUndo</span>
01220 <span class="comment">//---------------------------------------------------------</span>
01221 
<a name="l01222"></a><a class="code" href="classMuseScore.html#k47">01222</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k47">MuseScore::doUndo</a>()
01223       {
01224       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01225             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i8">doUndo</a>();
01226       }
01227 
01228 <span class="comment">//---------------------------------------------------------</span>
01229 <span class="comment">//   printFile</span>
01230 <span class="comment">//---------------------------------------------------------</span>
01231 
<a name="l01232"></a><a class="code" href="classMuseScore.html#k48">01232</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k48">MuseScore::printFile</a>()
01233       {
01234       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01235             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i0">printFile</a>();
01236       }
01237 
01238 <span class="comment">//---------------------------------------------------------</span>
01239 <span class="comment">//   padToggle</span>
01240 <span class="comment">//---------------------------------------------------------</span>
01241 
<a name="l01242"></a><a class="code" href="classMuseScore.html#k49">01242</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k49">MuseScore::padToggle</a>(<span class="keywordtype">int</span> n)
01243       {
01244       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01245             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i7">padToggle</a>(n);
01246       }
01247 
01248 <span class="comment">//---------------------------------------------------------</span>
01249 <span class="comment">//   cmdAddPitch</span>
01250 <span class="comment">//---------------------------------------------------------</span>
01251 
<a name="l01252"></a><a class="code" href="classMuseScore.html#k50">01252</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k50">MuseScore::cmdAddPitch</a>(<span class="keywordtype">int</span> n)
01253       {
01254       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01255             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i16">cmdAddPitch</a>(n);
01256       }
01257 
01258 <span class="comment">//---------------------------------------------------------</span>
01259 <span class="comment">//   midiReceived</span>
01260 <span class="comment">//---------------------------------------------------------</span>
01261 
<a name="l01262"></a><a class="code" href="classMuseScore.html#k53">01262</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k53">MuseScore::midiReceived</a>()
01263       {
01264       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01265             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i19">midiReceived</a>();
01266       }
01267 
01268 <span class="comment">//---------------------------------------------------------</span>
01269 <span class="comment">//   cmdNTole</span>
01270 <span class="comment">//---------------------------------------------------------</span>
01271 
<a name="l01272"></a><a class="code" href="classMuseScore.html#k52">01272</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k52">MuseScore::cmdNTole</a>(<span class="keywordtype">int</span> n)
01273       {
01274       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01275             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i18">cmdNTole</a>(n);
01276       }
01277 
01278 <span class="comment">//---------------------------------------------------------</span>
01279 <span class="comment">//   cmdAddIntervall</span>
01280 <span class="comment">//---------------------------------------------------------</span>
01281 
<a name="l01282"></a><a class="code" href="classMuseScore.html#k51">01282</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k51">MuseScore::cmdAddIntervall</a>(<span class="keywordtype">int</span> n)
01283       {
01284       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01285             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i17">cmdAddIntervall</a>(n);
01286       }
01287 
01288 <span class="comment">//---------------------------------------------------------</span>
01289 <span class="comment">//   cmdAddTitle</span>
01290 <span class="comment">//---------------------------------------------------------</span>
01291 
<a name="l01292"></a><a class="code" href="classMuseScore.html#k54">01292</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k54">MuseScore::cmdAddTitle</a>()
01293       {
01294       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01295             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i1">cmdAddTitle</a>();
01296       }
01297 
01298 <span class="comment">//---------------------------------------------------------</span>
01299 <span class="comment">//   cmdAddSubTitle</span>
01300 <span class="comment">//---------------------------------------------------------</span>
01301 
<a name="l01302"></a><a class="code" href="classMuseScore.html#k55">01302</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k55">MuseScore::cmdAddSubTitle</a>()
01303       {
01304       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01305             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i2">cmdAddSubTitle</a>();
01306       }
01307 
01308 <span class="comment">//---------------------------------------------------------</span>
01309 <span class="comment">//   cmdAddComposer</span>
01310 <span class="comment">//---------------------------------------------------------</span>
01311 
<a name="l01312"></a><a class="code" href="classMuseScore.html#k56">01312</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k56">MuseScore::cmdAddComposer</a>()
01313       {
01314       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01315             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i3">cmdAddComposer</a>();
01316       }
01317 
01318 <span class="comment">//---------------------------------------------------------</span>
01319 <span class="comment">//   cmdAddPoet</span>
01320 <span class="comment">//---------------------------------------------------------</span>
01321 
<a name="l01322"></a><a class="code" href="classMuseScore.html#k57">01322</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k57">MuseScore::cmdAddPoet</a>()
01323       {
01324       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01325             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i4">cmdAddPoet</a>();
01326       }
01327 
01328 <span class="comment">//---------------------------------------------------------</span>
01329 <span class="comment">//   addLyrics</span>
01330 <span class="comment">//---------------------------------------------------------</span>
01331 
<a name="l01332"></a><a class="code" href="classMuseScore.html#k58">01332</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k58">MuseScore::addLyrics</a>()
01333       {
01334       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01335             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i10">addLyrics</a>();
01336       }
01337 
01338 <span class="comment">//---------------------------------------------------------</span>
01339 <span class="comment">//   addExpression</span>
01340 <span class="comment">//---------------------------------------------------------</span>
01341 
<a name="l01342"></a><a class="code" href="classMuseScore.html#k59">01342</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k59">MuseScore::addExpression</a>()
01343       {
01344       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01345             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i14">addExpression</a>();
01346       }
01347 
01348 <span class="comment">//---------------------------------------------------------</span>
01349 <span class="comment">//   addTechnik</span>
01350 <span class="comment">//---------------------------------------------------------</span>
01351 
<a name="l01352"></a><a class="code" href="classMuseScore.html#k60">01352</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k60">MuseScore::addTechnik</a>()
01353       {
01354       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01355             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i12">addTechnik</a>();
01356       }
01357 
01358 <span class="comment">//---------------------------------------------------------</span>
01359 <span class="comment">//   addTempo</span>
01360 <span class="comment">//---------------------------------------------------------</span>
01361 
<a name="l01362"></a><a class="code" href="classMuseScore.html#k61">01362</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k61">MuseScore::addTempo</a>()
01363       {
01364       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01365             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i11">addTempo</a>();
01366       }
01367 
01368 <span class="comment">//---------------------------------------------------------</span>
01369 <span class="comment">//   addMetronome</span>
01370 <span class="comment">//---------------------------------------------------------</span>
01371 
<a name="l01372"></a><a class="code" href="classMuseScore.html#k62">01372</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k62">MuseScore::addMetronome</a>()
01373       {
01374       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01375             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i13">addMetronome</a>();
01376       }
01377 
01378 <span class="comment">//---------------------------------------------------------</span>
01379 <span class="comment">//   cmdAppendMeasure</span>
01380 <span class="comment">//---------------------------------------------------------</span>
01381 
<a name="l01382"></a><a class="code" href="classMuseScore.html#k63">01382</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k63">MuseScore::cmdAppendMeasure</a>()
01383       {
01384       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01385             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i5">cmdAppendMeasure</a>();
01386       }
01387 
01388 <span class="comment">//---------------------------------------------------------</span>
01389 <span class="comment">//   startNoteEntry</span>
01390 <span class="comment">//---------------------------------------------------------</span>
01391 
<a name="l01392"></a><a class="code" href="classMuseScore.html#k64">01392</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k64">MuseScore::startNoteEntry</a>()
01393       {
01394       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01395             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i15">startNoteEntry</a>();
01396       }
01397 
01398 <span class="comment">//---------------------------------------------------------</span>
01399 <span class="comment">//   resetUserStretch</span>
01400 <span class="comment">//---------------------------------------------------------</span>
01401 
<a name="l01402"></a><a class="code" href="classMuseScore.html#k65">01402</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k65">MuseScore::resetUserStretch</a>()
01403       {
01404       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01405             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i21">resetUserStretch</a>();
01406       }
01407 
01408 <span class="comment">//---------------------------------------------------------</span>
01409 <span class="comment">//   systemBreak</span>
01410 <span class="comment">//---------------------------------------------------------</span>
01411 
<a name="l01412"></a><a class="code" href="classMuseScore.html#k66">01412</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k66">MuseScore::systemBreak</a>()
01413       {
01414       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01415             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i23">systemBreak</a>();
01416       }
01417 
01418 <span class="comment">//---------------------------------------------------------</span>
01419 <span class="comment">//   pageBreak</span>
01420 <span class="comment">//---------------------------------------------------------</span>
01421 
<a name="l01422"></a><a class="code" href="classMuseScore.html#k67">01422</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k67">MuseScore::pageBreak</a>()
01423       {
01424       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01425             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i22">pageBreak</a>();
01426       }
01427 
01428 <span class="comment">//---------------------------------------------------------</span>
01429 <span class="comment">//   resetUserOffsets</span>
01430 <span class="comment">//---------------------------------------------------------</span>
01431 
<a name="l01432"></a><a class="code" href="classMuseScore.html#k68">01432</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k68">MuseScore::resetUserOffsets</a>()
01433       {
01434       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01435             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i20">resetUserOffsets</a>();
01436       }
01437 
01438 <span class="comment">//---------------------------------------------------------</span>
01439 <span class="comment">//   midiNoteReceived</span>
01440 <span class="comment">//---------------------------------------------------------</span>
01441 
<a name="l01442"></a><a class="code" href="classMuseScore.html#a10">01442</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#a10">MuseScore::midiNoteReceived</a>(<span class="keywordtype">int</span> pitch, <span class="keywordtype">bool</span> chord)
01443       {
01444       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r0">cs</a>)
01445             <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a108">midiNoteReceived</a>(pitch, chord);
01446       }
01447 
01448 <span class="comment">//---------------------------------------------------------</span>
01449 <span class="comment">//   showPageSettings</span>
01450 <span class="comment">//---------------------------------------------------------</span>
01451 
<a name="l01452"></a><a class="code" href="classMuseScore.html#k70">01452</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k70">MuseScore::showPageSettings</a>()
01453       {
01454       <span class="keywordflow">if</span> (<a class="code" href="classMuseScore.html#r33">pageSettings</a> == 0) {
01455             <a class="code" href="classMuseScore.html#r33">pageSettings</a> = <span class="keyword">new</span> <a class="code" href="classPageSettings.html">PageSettings</a>();
01456             connect(<a class="code" href="classMuseScore.html#r33">pageSettings</a>, SIGNAL(<a class="code" href="classMuseScore.html#k71">pageSettingsChanged</a>()), SLOT(<a class="code" href="classMuseScore.html#k71">pageSettingsChanged</a>()));
01457             }
01458       <a class="code" href="classMuseScore.html#r33">pageSettings</a>-&gt;<a class="code" href="classPageSettings.html#a1">setScore</a>(<a class="code" href="classMuseScore.html#r0">cs</a>);
01459       <a class="code" href="classMuseScore.html#r33">pageSettings</a>-&gt;show();
01460       <a class="code" href="classMuseScore.html#r33">pageSettings</a>-&gt;raise();
01461       }
01462 
01463 <span class="comment">//---------------------------------------------------------</span>
01464 <span class="comment">//   pageSettingsChanged</span>
01465 <span class="comment">//---------------------------------------------------------</span>
01466 
<a name="l01467"></a><a class="code" href="classMuseScore.html#k71">01467</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k71">MuseScore::pageSettingsChanged</a>()
01468       {
01469       <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#o12">pages</a>-&gt;<a class="code" href="classPageList.html#a1">update</a>(<a class="code" href="classMuseScore.html#r0">cs</a>);
01470       <a class="code" href="classMuseScore.html#r1">canvas</a>-&gt;<a class="code" href="classCanvas.html#a22">setMag</a>(<a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a115">mag</a>());
01471       <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a49">layout</a>();
01472       <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a85">setUpdateAll</a>();
01473       <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#i25">textStyleChanged</a>();    <span class="comment">// fix text styles (center, right etc.)</span>
01474       <a class="code" href="classMuseScore.html#r0">cs</a>-&gt;<a class="code" href="classScore.html#a84">endCmd</a>(<span class="keyword">false</span>);
01475       }
01476 
01477 
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Mon Jun 27 22:28:29 2005 for MuseScore by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
