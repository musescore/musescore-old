<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>MuseScore: preferences.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.7 -->
<div class="qindex"><a class="qindex" href="main.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a></div>
<h1>preferences.cpp</h1><a href="preferences_8cpp.html">Go to the documentation of this file.</a><pre class="fragment"><div>00001 <span class="comment">//=========================================================</span>
00002 <span class="comment">//  MuseScore</span>
00003 <span class="comment">//  Linux Music Score Editor</span>
00004 <span class="comment">//  $Id: preferences.cpp,v 1.17 2005/06/19 17:01:37 wschweer Exp $</span>
00005 <span class="comment">//</span>
00006 <span class="comment">//  (C) Copyright 2002-2005 Werner Schweer (ws@seh.de)</span>
00007 <span class="comment">//=========================================================</span>
00008 
00009 <span class="preprocessor">#include "<a class="code" href="xml_8h.html">xml.h</a>"</span>
00010 <span class="preprocessor">#include "<a class="code" href="project_8h.html">project.h</a>"</span>
00011 <span class="preprocessor">#include "<a class="code" href="mscore_8h.html">mscore.h</a>"</span>
00012 <span class="preprocessor">#include "<a class="code" href="preferences_8h.html">preferences.h</a>"</span>
00013 <span class="preprocessor">#include "<a class="code" href="synti_8h.html">synti.h</a>"</span>
00014 <span class="preprocessor">#include "<a class="code" href="seq_8h.html">seq.h</a>"</span>
00015 <span class="preprocessor">#include "<a class="code" href="note_8h.html">note.h</a>"</span>
00016 
00017 <span class="comment">//---------------------------------------------------------</span>
00018 <span class="comment">//   buttonId2stemDir</span>
00019 <span class="comment">//    convert button id (0=up, 1=auto, 2=down) to StemDirection</span>
00020 <span class="comment">//---------------------------------------------------------</span>
00021 
<a name="l00022"></a><a class="code" href="preferences_8cpp.html#a1">00022</a> <span class="keyword">static</span> <a class="code" href="globals_8h.html#a24">Direction</a> <a class="code" href="preferences_8cpp.html#a1">buttonId2stemDir</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)
00023       {
00024       <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == 0) {
00025             <span class="keywordflow">return</span> <a class="code" href="structUP.html">UP</a>;
00026             }
00027       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == 2) {
00028             <span class="keywordflow">return</span> <a class="code" href="globals_8h.html#a24a9">DOWN</a>;
00029             }
00030       <span class="keywordflow">else</span> {
00031             <span class="keywordflow">return</span> <a class="code" href="globals_8h.html#a24a7">AUTO</a>; <span class="comment">// default to "auto"</span>
00032             }
00033       }
00034 
00035 <span class="comment">//---------------------------------------------------------</span>
00036 <span class="comment">//   stemDir2buttonId</span>
00037 <span class="comment">//    convert StemDirection to button id (0=up, 1=auto, 2=down)</span>
00038 <span class="comment">//---------------------------------------------------------</span>
00039 
<a name="l00040"></a><a class="code" href="preferences_8cpp.html#a2">00040</a> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="preferences_8cpp.html#a2">stemDir2buttonId</a>(Direction dir)
00041       {
00042       <span class="keywordflow">if</span> (dir == <a class="code" href="structUP.html">UP</a>) {
00043             <span class="keywordflow">return</span> 0;
00044             }
00045       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dir == <a class="code" href="globals_8h.html#a24a9">DOWN</a>) {
00046             <span class="keywordflow">return</span> 2;
00047             }
00048       <span class="keywordflow">else</span> {
00049             <span class="keywordflow">return</span> 1;           <span class="comment">// default to "auto"</span>
00050             }
00051       }
00052 
00053 <span class="comment">//---------------------------------------------------------</span>
00054 <span class="comment">//   Preferences</span>
00055 <span class="comment">//---------------------------------------------------------</span>
00056 
<a name="l00057"></a><a class="code" href="preferences_8cpp.html#a0">00057</a> <a class="code" href="structPreferences.html">Preferences</a> <a class="code" href="preferences_8cpp.html#a0">preferences</a>;
00058 
<a name="l00059"></a><a class="code" href="structPreferences.html#a0">00059</a> <a class="code" href="structPreferences.html#a0">Preferences::Preferences</a>()
00060    :  printCmd("kprinter -c %s"), browseCmd("konqueror")
00061       {
00062       <a class="code" href="structPreferences.html#o9">selectColor</a>[0] = Qt::blue;
00063       <a class="code" href="structPreferences.html#o9">selectColor</a>[1] = Qt::green;
00064       <a class="code" href="structPreferences.html#o9">selectColor</a>[2] = Qt::yellow;
00065       <a class="code" href="structPreferences.html#o9">selectColor</a>[3] = Qt::magenta;
00066 
00067       <span class="keyword">const</span> <span class="keywordtype">char</span>* mscoreHome = getenv(<span class="stringliteral">"MSCORE"</span>);
00068       <span class="keywordflow">if</span> (mscoreHome == 0)
00069             mscoreHome = <span class="stringliteral">"/usr/share/mscore"</span>;
00070 
00071       <span class="comment">// set fallback defaults:</span>
00072 
00073       <a class="code" href="structPreferences.html#o2">cursorBlink</a> = <span class="keyword">false</span>;
00074       <a class="code" href="structPreferences.html#o4">fgUseColor</a>  = <span class="keyword">false</span>;
00075       <a class="code" href="structPreferences.html#o3">bgUseColor</a>  = <span class="keyword">true</span>;
00076       <a class="code" href="structPreferences.html#o6">fgWallpaper</a> = mscoreHome;
00077       <a class="code" href="structPreferences.html#o6">fgWallpaper</a> += <span class="stringliteral">"/wallpaper/paper2.png"</span>;
00078       <a class="code" href="structPreferences.html#o10">enableMidiInput</a> = <span class="keyword">true</span>;
00079       <a class="code" href="structPreferences.html#o11">playNotes</a>       = <span class="keyword">true</span>;
00080       <a class="code" href="structPreferences.html#o8">bgColor</a>.setRgb(0x19, 0x6c, 0xb9);
00081       <a class="code" href="structPreferences.html#o7">fgColor</a>.setRgb(50, 50, 50);
00082       <a class="code" href="structPreferences.html#o12">soundFont</a> = <span class="stringliteral">""</span>;
00083       <a class="code" href="structPreferences.html#o13">lPort</a>     = <span class="stringliteral">""</span>;
00084       <a class="code" href="structPreferences.html#o14">rPort</a>     = <span class="stringliteral">""</span>;
00085       <a class="code" href="structPreferences.html#o15">stemDir1</a>  = <a class="code" href="globals_8h.html#a24a7">AUTO</a>;
00086       <a class="code" href="structPreferences.html#o16">stemDir2</a>  = <a class="code" href="globals_8h.html#a24a7">AUTO</a>;
00087       <a class="code" href="structPreferences.html#o17">stemDir3</a>  = <a class="code" href="globals_8h.html#a24a7">AUTO</a>;
00088       <a class="code" href="structPreferences.html#o18">stemDir4</a>  = <a class="code" href="globals_8h.html#a24a7">AUTO</a>;
00089       <a class="code" href="structPreferences.html#o19">stemDir5</a>  = <a class="code" href="globals_8h.html#a24a7">AUTO</a>;
00090       };
00091 
00092 <span class="comment">//---------------------------------------------------------</span>
00093 <span class="comment">//   write</span>
00094 <span class="comment">//---------------------------------------------------------</span>
00095 
<a name="l00096"></a><a class="code" href="structPreferences.html#a1">00096</a> <span class="keywordtype">void</span> <a class="code" href="structPreferences.html#a1">Preferences::write</a>()
00097       {
00098       <span class="keywordtype">char</span>* p = getenv(<span class="stringliteral">"HOME"</span>);
00099       <span class="keywordflow">if</span> (p == 0) {
00100             <span class="keywordflow">if</span> (<a class="code" href="element_8cpp.html#a0">debugMode</a>)
00101                   fprintf(stderr, <span class="stringliteral">"no HOME environment variable\n"</span>);
00102             <span class="keywordflow">return</span>;
00103             }
00104       <span class="keywordtype">char</span> confname[strlen(p) + 9];
00105       sprintf(confname, <span class="stringliteral">"%s/.mscore"</span>, p);
00106       FILE* f = fopen(confname, <span class="stringliteral">"w"</span>);
00107       <span class="keywordflow">if</span> (f == 0) {
00108             <span class="keywordflow">if</span> (<a class="code" href="element_8cpp.html#a0">debugMode</a>) {
00109                   printf(<span class="stringliteral">"Preferences: open(%s) failed: %s\n"</span>,
00110                      confname, strerror(errno));
00111                   }
00112             <span class="keywordflow">return</span>;
00113             }
00114       <a class="code" href="classXml.html">Xml</a> xml(f);
00115       xml.<a class="code" href="classXml.html#a4">header</a>();
00116       xml.<a class="code" href="classXml.html#a8">tag</a>(<span class="stringliteral">"museScore version=\"1.0\""</span>);
00117       xml.<a class="code" href="classXml.html#a8">tag</a>(<span class="stringliteral">"Preferences"</span>);
00118       xml.<a class="code" href="classXml.html#a16">strTag</a>(<span class="stringliteral">"printCmd"</span>, <a class="code" href="structPreferences.html#o0">printCmd</a>);
00119       xml.<a class="code" href="classXml.html#a16">strTag</a>(<span class="stringliteral">"browseCmd"</span>, <a class="code" href="structPreferences.html#o1">browseCmd</a>);
00120       xml.<a class="code" href="classXml.html#a12">intTag</a>(<span class="stringliteral">"cursorBlink"</span>, <a class="code" href="structPreferences.html#o2">cursorBlink</a>);
00121       <span class="keywordflow">if</span> (<a class="code" href="structPreferences.html#o4">fgUseColor</a>)
00122             xml.<a class="code" href="classXml.html#a16">strTag</a>(<span class="stringliteral">"fgColor"</span>, <a class="code" href="structPreferences.html#o7">fgColor</a>.name());
00123       <span class="keywordflow">else</span>
00124             xml.<a class="code" href="classXml.html#a16">strTag</a>(<span class="stringliteral">"fgWallpaper"</span>, <a class="code" href="structPreferences.html#o6">fgWallpaper</a>);
00125       <span class="keywordflow">if</span> (<a class="code" href="structPreferences.html#o3">bgUseColor</a>)
00126             xml.<a class="code" href="classXml.html#a16">strTag</a>(<span class="stringliteral">"bgColor"</span>, <a class="code" href="structPreferences.html#o8">bgColor</a>.name());
00127       <span class="keywordflow">else</span>
00128             xml.<a class="code" href="classXml.html#a16">strTag</a>(<span class="stringliteral">"bgWallpaper"</span>, <a class="code" href="structPreferences.html#o5">bgWallpaper</a>);
00129       xml.<a class="code" href="classXml.html#a16">strTag</a>(<span class="stringliteral">"selectColor1"</span>, <a class="code" href="structPreferences.html#o9">selectColor</a>[0].name());
00130       xml.<a class="code" href="classXml.html#a16">strTag</a>(<span class="stringliteral">"selectColor2"</span>, <a class="code" href="structPreferences.html#o9">selectColor</a>[1].name());
00131       xml.<a class="code" href="classXml.html#a16">strTag</a>(<span class="stringliteral">"selectColor3"</span>, <a class="code" href="structPreferences.html#o9">selectColor</a>[2].name());
00132       xml.<a class="code" href="classXml.html#a16">strTag</a>(<span class="stringliteral">"selectColor4"</span>, <a class="code" href="structPreferences.html#o9">selectColor</a>[3].name());
00133       xml.<a class="code" href="classXml.html#a12">intTag</a>(<span class="stringliteral">"enableMidiInput"</span>, <a class="code" href="structPreferences.html#o10">enableMidiInput</a>);
00134       xml.<a class="code" href="classXml.html#a12">intTag</a>(<span class="stringliteral">"playNotes"</span>, <a class="code" href="structPreferences.html#o11">playNotes</a>);
00135       xml.<a class="code" href="classXml.html#a16">strTag</a>(<span class="stringliteral">"lPort"</span>, <a class="code" href="structPreferences.html#o13">lPort</a>);
00136       xml.<a class="code" href="classXml.html#a16">strTag</a>(<span class="stringliteral">"rPort"</span>, <a class="code" href="structPreferences.html#o14">rPort</a>);
00137       <span class="keywordflow">if</span> (!<a class="code" href="structPreferences.html#o12">soundFont</a>.isEmpty())
00138             xml.<a class="code" href="classXml.html#a16">strTag</a>(<span class="stringliteral">"soundFont"</span>, <a class="code" href="structPreferences.html#o12">soundFont</a>);
00139       xml.<a class="code" href="classXml.html#a12">intTag</a>(<span class="stringliteral">"stemDirection1"</span>, <a class="code" href="structPreferences.html#o15">stemDir1</a>);
00140       xml.<a class="code" href="classXml.html#a12">intTag</a>(<span class="stringliteral">"stemDirection2"</span>, <a class="code" href="structPreferences.html#o16">stemDir2</a>);
00141       xml.<a class="code" href="classXml.html#a12">intTag</a>(<span class="stringliteral">"stemDirection3"</span>, <a class="code" href="structPreferences.html#o17">stemDir3</a>);
00142       xml.<a class="code" href="classXml.html#a12">intTag</a>(<span class="stringliteral">"stemDirection4"</span>, <a class="code" href="structPreferences.html#o18">stemDir4</a>);
00143       xml.<a class="code" href="classXml.html#a12">intTag</a>(<span class="stringliteral">"stemDirection5"</span>, <a class="code" href="structPreferences.html#o19">stemDir5</a>);
00144       xml.<a class="code" href="classXml.html#a9">etag</a>(<span class="stringliteral">"Preferences"</span>);
00145       xml.<a class="code" href="classXml.html#a9">etag</a>(<span class="stringliteral">"museScore"</span>);
00146       fclose(f);
00147       }
00148 
00149 <span class="comment">//---------------------------------------------------------</span>
00150 <span class="comment">//   read</span>
00151 <span class="comment">//---------------------------------------------------------</span>
00152 
<a name="l00153"></a><a class="code" href="structPreferences.html#a2">00153</a> <span class="keywordtype">void</span> <a class="code" href="structPreferences.html#a2">Preferences::read</a>()
00154       {
00155       <span class="keywordtype">char</span>* p = getenv(<span class="stringliteral">"HOME"</span>);
00156       <span class="keywordflow">if</span> (p == 0) {
00157             <span class="keywordflow">if</span> (<a class="code" href="element_8cpp.html#a0">debugMode</a>)
00158                   fprintf(stderr, <span class="stringliteral">"no HOME environment variable\n"</span>);
00159             <span class="keywordflow">return</span>;
00160             }
00161       <span class="keywordtype">char</span> confname[strlen(p) + 9];
00162       sprintf(confname, <span class="stringliteral">"%s/.mscore"</span>, p);
00163       FILE* f = fopen(confname, <span class="stringliteral">"r"</span>);
00164       <span class="keywordflow">if</span> (f == 0) {
00165             <span class="keywordflow">if</span> (<a class="code" href="element_8cpp.html#a0">debugMode</a>) {
00166                   printf(<span class="stringliteral">"Preferences: open(%s) failed: %s\n"</span>,
00167                      confname, strerror(errno));
00168                   }
00169             <span class="keywordflow">return</span>;
00170             }
00171 
00172       QFile qf(confname);
00173       qf.open(QIODevice::ReadOnly, f);
00174 
00175       QDomDocument doc;
00176       <span class="keywordtype">int</span> line, column;
00177       QString err;
00178       <span class="keywordflow">if</span> (!doc.setContent(&amp;qf, <span class="keyword">false</span>, &amp;err, &amp;line, &amp;column)) {
00179             printf(<span class="stringliteral">"error reading file %s at line %d column %d: %s\n"</span>,
00180                confname, line, column, err.latin1());
00181             <span class="keywordflow">return</span>;
00182             }
00183       QDomNode node = doc.documentElement();
00184       <span class="keywordflow">while</span> (!node.isNull()) {
00185             QDomElement e = node.toElement();
00186             <span class="keywordflow">if</span> (e.isNull())
00187                   <span class="keywordflow">continue</span>;
00188             <span class="keywordflow">if</span> (e.tagName() == <span class="stringliteral">"museScore"</span>) {
00189                   QDomNode nnode = node.firstChild();
00190                   <span class="keywordflow">while</span> (!nnode.isNull()) {
00191                         QDomElement e = nnode.toElement();
00192                         <span class="keywordflow">if</span> (e.isNull())
00193                               <span class="keywordflow">continue</span>;
00194                         <span class="keywordflow">if</span> (e.tagName() == <span class="stringliteral">"Preferences"</span>) {
00195                               QDomNode nnnode = nnode.firstChild();
00196                               <span class="keywordflow">while</span> (!nnnode.isNull()) {
00197                                     QDomElement e = nnnode.toElement();
00198                                     <span class="keywordflow">if</span> (e.isNull())
00199                                           <span class="keywordflow">continue</span>;
00200                                     QString tag(e.tagName());
00201                                     QString val(e.text());
00202                                     <span class="keywordtype">int</span> i = val.toInt();
00203                                     <span class="keywordflow">if</span> (tag == <span class="stringliteral">"printCmd"</span>)
00204                                           <a class="code" href="structPreferences.html#o0">printCmd</a> = val;
00205                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"browseCmd"</span>)
00206                                           <a class="code" href="structPreferences.html#o1">browseCmd</a> = val;
00207                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"cursorBlink"</span>)
00208                                           <a class="code" href="structPreferences.html#o2">cursorBlink</a> = i;
00209                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"fgColor"</span>) {
00210                                           <a class="code" href="structPreferences.html#o7">fgColor</a>.setNamedColor(val);
00211                                           <a class="code" href="structPreferences.html#o4">fgUseColor</a> = <span class="keyword">true</span>;
00212                                           }
00213                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"bgColor"</span>) {
00214                                           <a class="code" href="structPreferences.html#o8">bgColor</a>.setNamedColor(val);
00215                                           <a class="code" href="structPreferences.html#o3">bgUseColor</a> = <span class="keyword">true</span>;
00216                                           }
00217                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"fgWallpaper"</span>) {
00218                                           <a class="code" href="structPreferences.html#o6">fgWallpaper</a> = val;
00219                                           <a class="code" href="structPreferences.html#o4">fgUseColor</a> = <span class="keyword">false</span>;
00220                                           }
00221                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"bgWallpaper"</span>) {
00222                                           <a class="code" href="structPreferences.html#o5">bgWallpaper</a> = val;
00223                                           <a class="code" href="structPreferences.html#o3">bgUseColor</a> = <span class="keyword">false</span>;
00224                                           }
00225                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"selectColor"</span>)      <span class="comment">// obsolete</span>
00226                                           <a class="code" href="structPreferences.html#o9">selectColor</a>[0].setNamedColor(val);
00227                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"selectColor1"</span>)
00228                                           <a class="code" href="structPreferences.html#o9">selectColor</a>[0].setNamedColor(val);
00229                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"selectColor2"</span>)
00230                                           <a class="code" href="structPreferences.html#o9">selectColor</a>[1].setNamedColor(val);
00231                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"selectColor3"</span>)
00232                                           <a class="code" href="structPreferences.html#o9">selectColor</a>[2].setNamedColor(val);
00233                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"selectColor4"</span>)
00234                                           <a class="code" href="structPreferences.html#o9">selectColor</a>[3].setNamedColor(val);
00235                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"enableMidiInput"</span>)
00236                                           <a class="code" href="structPreferences.html#o10">enableMidiInput</a> = i;
00237                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"playNotes"</span>)
00238                                           <a class="code" href="structPreferences.html#o11">playNotes</a> = i;
00239                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"soundFont"</span>)
00240                                           <a class="code" href="structPreferences.html#o12">soundFont</a> = val;
00241                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"rPort"</span>)
00242                                           <a class="code" href="structPreferences.html#o14">rPort</a> = val;
00243                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"lPort"</span>)
00244                                           <a class="code" href="structPreferences.html#o13">lPort</a> = val;
00245                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"stemDirection1"</span>)
00246                                           <a class="code" href="structPreferences.html#o15">stemDir1</a> = <a class="code" href="globals_8h.html#a24">Direction</a>(i);
00247                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"stemDirection2"</span>)
00248                                           <a class="code" href="structPreferences.html#o16">stemDir2</a> = <a class="code" href="globals_8h.html#a24">Direction</a>(i);
00249                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"stemDirection3"</span>)
00250                                           <a class="code" href="structPreferences.html#o17">stemDir3</a> = <a class="code" href="globals_8h.html#a24">Direction</a>(i);
00251                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"stemDirection4"</span>)
00252                                           <a class="code" href="structPreferences.html#o18">stemDir4</a> = <a class="code" href="globals_8h.html#a24">Direction</a>(i);
00253                                     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (tag == <span class="stringliteral">"stemDirection5"</span>)
00254                                           <a class="code" href="structPreferences.html#o19">stemDir5</a> = <a class="code" href="globals_8h.html#a24">Direction</a>(i);
00255                                     <span class="keywordflow">else</span>
00256                                           printf(<span class="stringliteral">"Mscore:Preferences: unknown tag %s\n"</span>,
00257                                              tag.latin1());
00258                                     nnnode = nnnode.nextSibling();
00259                                     }
00260                               }
00261                         nnode = nnode.nextSibling();
00262                         }
00263                   }
00264             node = node.nextSibling();
00265             }
00266       }
00267 
00268 <span class="comment">//---------------------------------------------------------</span>
00269 <span class="comment">//   preferences</span>
00270 <span class="comment">//---------------------------------------------------------</span>
00271 
<a name="l00272"></a><a class="code" href="classMuseScore.html#k10">00272</a> <span class="keywordtype">void</span> <a class="code" href="classMuseScore.html#k10">MuseScore::startPreferenceDialog</a>()
00273       {
00274       <span class="keywordflow">if</span> (!<a class="code" href="classMuseScore.html#r19">preferenceDialog</a>) {
00275             <a class="code" href="classMuseScore.html#r19">preferenceDialog</a> = <span class="keyword">new</span> <a class="code" href="classPreferenceDialog.html">PreferenceDialog</a>(<span class="keyword">this</span>);
00276             connect(<a class="code" href="classMuseScore.html#r19">preferenceDialog</a>, SIGNAL(<a class="code" href="classMuseScore.html#k14">preferencesChanged</a>()),
00277                SLOT(<a class="code" href="classMuseScore.html#k14">preferencesChanged</a>()));
00278             }
00279       <a class="code" href="classMuseScore.html#r19">preferenceDialog</a>-&gt;show();
00280       }
00281 
00282 <span class="comment">//---------------------------------------------------------</span>
00283 <span class="comment">//   PreferenceDialog</span>
00284 <span class="comment">//---------------------------------------------------------</span>
00285 
<a name="l00286"></a><a class="code" href="classPreferenceDialog.html#a0">00286</a> <a class="code" href="classPreferenceDialog.html#a0">PreferenceDialog::PreferenceDialog</a>(QWidget* parent)
00287    : <a class="code" href="classPrefsDialogBase.html">PrefsDialogBase</a>(parent)
00288       {
00289       connect(buttonOk, SIGNAL(pressed()), SLOT(<a class="code" href="classPreferenceDialog.html#k0">ok</a>()));
00290       connect(buttonCancel, SIGNAL(pressed()), SLOT(<a class="code" href="classPreferenceDialog.html#k1">cancel</a>()));
00291       printCmdEdit-&gt;setText(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o0">printCmd</a>);
00292       browseCmdEdit-&gt;setText(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o1">browseCmd</a>);
00293       cursorBlink-&gt;setChecked(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o2">cursorBlink</a>);
00294 
00295       Q3ButtonGroup* fgButtons = <span class="keyword">new</span> Q3ButtonGroup(<span class="keyword">this</span>);
00296       fgButtons-&gt;hide();
00297       fgButtons-&gt;setExclusive(<span class="keyword">true</span>);
00298       fgButtons-&gt;insert(fgColorButton, 0);
00299       fgButtons-&gt;insert(fgWallpaperButton, 1);
00300       connect(fgButtons, SIGNAL(clicked(<span class="keywordtype">int</span>)), SLOT(<a class="code" href="classPreferenceDialog.html#k3">fgClicked</a>(<span class="keywordtype">int</span>)));
00301 
00302       Q3ButtonGroup* bgButtons = <span class="keyword">new</span> Q3ButtonGroup(<span class="keyword">this</span>);
00303       bgButtons-&gt;hide();
00304       bgButtons-&gt;setExclusive(<span class="keyword">true</span>);
00305       bgButtons-&gt;insert(bgColorButton, 0);
00306       bgButtons-&gt;insert(bgWallpaperButton, 1);
00307       connect(bgButtons, SIGNAL(clicked(<span class="keywordtype">int</span>)), SLOT(<a class="code" href="classPreferenceDialog.html#k2">bgClicked</a>(<span class="keywordtype">int</span>)));
00308 
00309       fgWallpaper-&gt;setText(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o6">fgWallpaper</a>);
00310       bgWallpaper-&gt;setText(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o5">bgWallpaper</a>);
00311       fgColorLabel-&gt;setBackgroundColor(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o7">fgColor</a>);
00312       bgColorLabel-&gt;setBackgroundColor(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o8">bgColor</a>);
00313       selectColorLabel1-&gt;setBackgroundColor(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o9">selectColor</a>[0]);
00314       selectColorLabel2-&gt;setBackgroundColor(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o9">selectColor</a>[1]);
00315       selectColorLabel3-&gt;setBackgroundColor(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o9">selectColor</a>[2]);
00316       selectColorLabel4-&gt;setBackgroundColor(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o9">selectColor</a>[3]);
00317 
00318       bgButtons-&gt;setButton(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o3">bgUseColor</a> ? 0 : 1);
00319       fgButtons-&gt;setButton(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o4">fgUseColor</a> ? 0 : 1);
00320 
00321       enableMidiInput-&gt;setChecked(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o10">enableMidiInput</a>);
00322       playNotes-&gt;setChecked(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o11">playNotes</a>);
00323       soundFont-&gt;setText(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o12">soundFont</a>);
00324 
00325       <span class="keywordflow">if</span> (<a class="code" href="seq_8cpp.html#a0">seq</a>-&gt;<a class="code" href="classSeq.html#a4">isRunning</a>()) {
00326             std::list&lt;QString&gt; sl = <a class="code" href="seq_8cpp.html#a0">seq</a>-&gt;<a class="code" href="classSeq.html#a7">inputPorts</a>();
00327             <span class="keywordtype">int</span> idx = 0;
00328             <span class="keywordflow">for</span> (std::list&lt;QString&gt;::iterator i = sl.begin(); i != sl.end(); ++i, ++idx) {
00329                   jackRPort-&gt;insertItem(*i);
00330                   jackLPort-&gt;insertItem(*i);
00331                   <span class="keywordflow">if</span> (<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o14">rPort</a> == *i)
00332                         jackRPort-&gt;setCurrentItem(idx);
00333                   <span class="keywordflow">if</span> (<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o13">lPort</a> == *i)
00334                         jackLPort-&gt;setCurrentItem(idx);
00335                   }
00336             }
00337       <span class="keywordflow">else</span> {
00338             jackRPort-&gt;setEnabled(<span class="keyword">false</span>);
00339             jackLPort-&gt;setEnabled(<span class="keyword">false</span>);
00340             }
00341 
00342       buttonGroup1-&gt;setButton(<a class="code" href="preferences_8cpp.html#a2">stemDir2buttonId</a>(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o15">stemDir1</a>));
00343       buttonGroup2-&gt;setButton(<a class="code" href="preferences_8cpp.html#a2">stemDir2buttonId</a>(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o16">stemDir2</a>));
00344       buttonGroup3-&gt;setButton(<a class="code" href="preferences_8cpp.html#a2">stemDir2buttonId</a>(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o17">stemDir3</a>));
00345       buttonGroup4-&gt;setButton(<a class="code" href="preferences_8cpp.html#a2">stemDir2buttonId</a>(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o18">stemDir4</a>));
00346       buttonGroup5-&gt;setButton(<a class="code" href="preferences_8cpp.html#a2">stemDir2buttonId</a>(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o19">stemDir5</a>));
00347 
00348       connect(fgColorSelect, SIGNAL(clicked()), SLOT(<a class="code" href="classPreferenceDialog.html#k4">selectFgColor</a>()));
00349       connect(bgColorSelect, SIGNAL(clicked()), SLOT(<a class="code" href="classPreferenceDialog.html#k5">selectBgColor</a>()));
00350       connect(selectColorSelect1, SIGNAL(clicked()), SLOT(<a class="code" href="classPreferenceDialog.html#k6">selectSelectColor1</a>()));
00351       connect(selectColorSelect2, SIGNAL(clicked()), SLOT(<a class="code" href="classPreferenceDialog.html#k7">selectSelectColor2</a>()));
00352       connect(selectColorSelect3, SIGNAL(clicked()), SLOT(<a class="code" href="classPreferenceDialog.html#k8">selectSelectColor3</a>()));
00353       connect(selectColorSelect4, SIGNAL(clicked()), SLOT(<a class="code" href="classPreferenceDialog.html#k9">selectSelectColor4</a>()));
00354       connect(fgWallpaperSelect, SIGNAL(clicked()), SLOT(<a class="code" href="classPreferenceDialog.html#k10">selectFgWallpaper</a>()));
00355       connect(bgWallpaperSelect, SIGNAL(clicked()), SLOT(<a class="code" href="classPreferenceDialog.html#k11">selectBgWallpaper</a>()));
00356       connect(sfButton, SIGNAL(clicked()), SLOT(<a class="code" href="classPreferenceDialog.html#k12">selectSoundFont</a>()));
00357       connect(jackRPort, SIGNAL(activated(<span class="keywordtype">int</span>)), SLOT(<a class="code" href="classPreferenceDialog.html#k13">selectRPort</a>(<span class="keywordtype">int</span>)));
00358       connect(jackLPort, SIGNAL(activated(<span class="keywordtype">int</span>)), SLOT(<a class="code" href="classPreferenceDialog.html#k14">selectLPort</a>(<span class="keywordtype">int</span>)));
00359       <a class="code" href="classPreferenceDialog.html#r0">sfChanged</a> = <span class="keyword">false</span>;
00360       }
00361 
00362 <span class="comment">//---------------------------------------------------------</span>
00363 <span class="comment">//   selectFgColor</span>
00364 <span class="comment">//---------------------------------------------------------</span>
00365 
<a name="l00366"></a><a class="code" href="classPreferenceDialog.html#k4">00366</a> <span class="keywordtype">void</span> <a class="code" href="classPreferenceDialog.html#k4">PreferenceDialog::selectFgColor</a>()
00367       {
00368       QColor c = QColorDialog::getColor(fgColorLabel-&gt;backgroundColor(), <span class="keyword">this</span>);
00369       <span class="keywordflow">if</span> (c.isValid())
00370             fgColorLabel-&gt;setBackgroundColor(c);
00371       }
00372 
00373 <span class="comment">//---------------------------------------------------------</span>
00374 <span class="comment">//   selectBgColor</span>
00375 <span class="comment">//---------------------------------------------------------</span>
00376 
<a name="l00377"></a><a class="code" href="classPreferenceDialog.html#k5">00377</a> <span class="keywordtype">void</span> <a class="code" href="classPreferenceDialog.html#k5">PreferenceDialog::selectBgColor</a>()
00378       {
00379       QColor c = QColorDialog::getColor(bgColorLabel-&gt;backgroundColor(), <span class="keyword">this</span>);
00380       <span class="keywordflow">if</span> (c.isValid())
00381             bgColorLabel-&gt;setBackgroundColor(c);
00382       }
00383 
00384 <span class="comment">//---------------------------------------------------------</span>
00385 <span class="comment">//   selectSelectColor1</span>
00386 <span class="comment">//---------------------------------------------------------</span>
00387 
<a name="l00388"></a><a class="code" href="classPreferenceDialog.html#k6">00388</a> <span class="keywordtype">void</span> <a class="code" href="classPreferenceDialog.html#k6">PreferenceDialog::selectSelectColor1</a>()
00389       {
00390       QColor c = QColorDialog::getColor(selectColorLabel1-&gt;backgroundColor(), <span class="keyword">this</span>);
00391       <span class="keywordflow">if</span> (c.isValid())
00392             selectColorLabel1-&gt;setBackgroundColor(c);
00393       }
00394 
00395 <span class="comment">//---------------------------------------------------------</span>
00396 <span class="comment">//   selectSelectColor2</span>
00397 <span class="comment">//---------------------------------------------------------</span>
00398 
<a name="l00399"></a><a class="code" href="classPreferenceDialog.html#k7">00399</a> <span class="keywordtype">void</span> <a class="code" href="classPreferenceDialog.html#k7">PreferenceDialog::selectSelectColor2</a>()
00400       {
00401       QColor c = QColorDialog::getColor(selectColorLabel2-&gt;backgroundColor(), <span class="keyword">this</span>);
00402       <span class="keywordflow">if</span> (c.isValid())
00403             selectColorLabel2-&gt;setBackgroundColor(c);
00404       }
00405 
00406 <span class="comment">//---------------------------------------------------------</span>
00407 <span class="comment">//   selectSelectColor3</span>
00408 <span class="comment">//---------------------------------------------------------</span>
00409 
<a name="l00410"></a><a class="code" href="classPreferenceDialog.html#k8">00410</a> <span class="keywordtype">void</span> <a class="code" href="classPreferenceDialog.html#k8">PreferenceDialog::selectSelectColor3</a>()
00411       {
00412       QColor c = QColorDialog::getColor(selectColorLabel3-&gt;backgroundColor(), <span class="keyword">this</span>);
00413       <span class="keywordflow">if</span> (c.isValid())
00414             selectColorLabel3-&gt;setBackgroundColor(c);
00415       }
00416 
00417 <span class="comment">//---------------------------------------------------------</span>
00418 <span class="comment">//   selectSelectColor4</span>
00419 <span class="comment">//---------------------------------------------------------</span>
00420 
<a name="l00421"></a><a class="code" href="classPreferenceDialog.html#k9">00421</a> <span class="keywordtype">void</span> <a class="code" href="classPreferenceDialog.html#k9">PreferenceDialog::selectSelectColor4</a>()
00422       {
00423       QColor c = QColorDialog::getColor(selectColorLabel4-&gt;backgroundColor(), <span class="keyword">this</span>);
00424       <span class="keywordflow">if</span> (c.isValid())
00425             selectColorLabel4-&gt;setBackgroundColor(c);
00426       }
00427 
00428 <span class="comment">//---------------------------------------------------------</span>
00429 <span class="comment">//   selectFgWallpaper</span>
00430 <span class="comment">//---------------------------------------------------------</span>
00431 
<a name="l00432"></a><a class="code" href="classPreferenceDialog.html#k10">00432</a> <span class="keywordtype">void</span> <a class="code" href="classPreferenceDialog.html#k10">PreferenceDialog::selectFgWallpaper</a>()
00433       {
00434       QString s = Q3FileDialog::getOpenFileName(fgWallpaper-&gt;text(),
00435          tr(<span class="stringliteral">"Images (*.jpg *.gif *.png)"</span>),
00436          <span class="keyword">this</span>,
00437          tr(<span class="stringliteral">"select fg wallpaper"</span>),
00438          tr(<span class="stringliteral">"Choose Notepaper"</span>)
00439          );
00440       <span class="keywordflow">if</span> (!s.isNull())
00441             fgWallpaper-&gt;setText(s);
00442       }
00443 
00444 <span class="comment">//---------------------------------------------------------</span>
00445 <span class="comment">//   selectBgWallpaper</span>
00446 <span class="comment">//---------------------------------------------------------</span>
00447 
<a name="l00448"></a><a class="code" href="classPreferenceDialog.html#k11">00448</a> <span class="keywordtype">void</span> <a class="code" href="classPreferenceDialog.html#k11">PreferenceDialog::selectBgWallpaper</a>()
00449       {
00450       QString s = Q3FileDialog::getOpenFileName(bgWallpaper-&gt;text(),
00451          tr(<span class="stringliteral">"Images (*.jpg *.gif *.png)"</span>),
00452          <span class="keyword">this</span>,
00453          tr(<span class="stringliteral">"select bg wallpaper"</span>),
00454          tr(<span class="stringliteral">"Choose Background Wallpaper"</span>)
00455          );
00456       <span class="keywordflow">if</span> (!s.isNull())
00457             bgWallpaper-&gt;setText(s);
00458       }
00459 
00460 <span class="comment">//---------------------------------------------------------</span>
00461 <span class="comment">//   selectSoundFont</span>
00462 <span class="comment">//---------------------------------------------------------</span>
00463 
<a name="l00464"></a><a class="code" href="classPreferenceDialog.html#k12">00464</a> <span class="keywordtype">void</span> <a class="code" href="classPreferenceDialog.html#k12">PreferenceDialog::selectSoundFont</a>()
00465       {
00466       QString s = Q3FileDialog::getOpenFileName(soundFont-&gt;text(),
00467          tr(<span class="stringliteral">"Sound Fonds (*.sf2 *.SF2);;All (*)"</span>),
00468          <span class="keyword">this</span>,
00469          tr(<span class="stringliteral">"select sound font"</span>),
00470          tr(<span class="stringliteral">"Choose Synthesizer Sound Font"</span>)
00471          );
00472       <span class="keywordflow">if</span> (!s.isNull()) {
00473             <a class="code" href="classPreferenceDialog.html#r0">sfChanged</a> = soundFont-&gt;text() != s;
00474             soundFont-&gt;setText(s);
00475             }
00476       }
00477 
00478 <span class="comment">//---------------------------------------------------------</span>
00479 <span class="comment">//   fgClicked</span>
00480 <span class="comment">//---------------------------------------------------------</span>
00481 
<a name="l00482"></a><a class="code" href="classPreferenceDialog.html#k3">00482</a> <span class="keywordtype">void</span> <a class="code" href="classPreferenceDialog.html#k3">PreferenceDialog::fgClicked</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)
00483       {
00484       fgColorLabel-&gt;setEnabled(!<span class="keywordtype">id</span>);
00485       fgColorSelect-&gt;setEnabled(!<span class="keywordtype">id</span>);
00486       fgWallpaper-&gt;setEnabled(<span class="keywordtype">id</span>);
00487       fgWallpaperSelect-&gt;setEnabled(<span class="keywordtype">id</span>);
00488       }
00489 
00490 <span class="comment">//---------------------------------------------------------</span>
00491 <span class="comment">//   bgClicked</span>
00492 <span class="comment">//---------------------------------------------------------</span>
00493 
<a name="l00494"></a><a class="code" href="classPreferenceDialog.html#k2">00494</a> <span class="keywordtype">void</span> <a class="code" href="classPreferenceDialog.html#k2">PreferenceDialog::bgClicked</a>(<span class="keywordtype">int</span> <span class="keywordtype">id</span>)
00495       {
00496       bgColorLabel-&gt;setEnabled(!<span class="keywordtype">id</span>);
00497       bgColorSelect-&gt;setEnabled(!<span class="keywordtype">id</span>);
00498       bgWallpaper-&gt;setEnabled(<span class="keywordtype">id</span>);
00499       bgWallpaperSelect-&gt;setEnabled(<span class="keywordtype">id</span>);
00500       }
00501 
00502 <span class="comment">//---------------------------------------------------------</span>
00503 <span class="comment">//   selectRPort</span>
00504 <span class="comment">//---------------------------------------------------------</span>
00505 
<a name="l00506"></a><a class="code" href="classPreferenceDialog.html#k13">00506</a> <span class="keywordtype">void</span> <a class="code" href="classPreferenceDialog.html#k13">PreferenceDialog::selectRPort</a>(<span class="keywordtype">int</span>)
00507       {
00508 
00509       }
00510 
00511 <span class="comment">//---------------------------------------------------------</span>
00512 <span class="comment">//   selectLPort</span>
00513 <span class="comment">//---------------------------------------------------------</span>
00514 
<a name="l00515"></a><a class="code" href="classPreferenceDialog.html#k14">00515</a> <span class="keywordtype">void</span> <a class="code" href="classPreferenceDialog.html#k14">PreferenceDialog::selectLPort</a>(<span class="keywordtype">int</span>)
00516       {
00517 
00518       }
00519 
00520 <span class="comment">//---------------------------------------------------------</span>
00521 <span class="comment">//   ok</span>
00522 <span class="comment">//---------------------------------------------------------</span>
00523 
<a name="l00524"></a><a class="code" href="classPreferenceDialog.html#k0">00524</a> <span class="keywordtype">void</span> <a class="code" href="classPreferenceDialog.html#k0">PreferenceDialog::ok</a>()
00525       {
00526       <a class="code" href="classPreferenceDialog.html#d0">apply</a>();
00527       <a class="code" href="classPreferenceDialog.html#k1">cancel</a>();
00528       }
00529 
00530 <span class="comment">//---------------------------------------------------------</span>
00531 <span class="comment">//   cancel</span>
00532 <span class="comment">//---------------------------------------------------------</span>
00533 
<a name="l00534"></a><a class="code" href="classPreferenceDialog.html#k1">00534</a> <span class="keywordtype">void</span> <a class="code" href="classPreferenceDialog.html#k1">PreferenceDialog::cancel</a>()
00535       {
00536       hide();
00537       }
00538 
00539 <span class="comment">//---------------------------------------------------------</span>
00540 <span class="comment">//   apply</span>
00541 <span class="comment">//---------------------------------------------------------</span>
00542 
<a name="l00543"></a><a class="code" href="classPreferenceDialog.html#d0">00543</a> <span class="keywordtype">void</span> <a class="code" href="classPreferenceDialog.html#d0">PreferenceDialog::apply</a>()
00544       {
00545       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o9">selectColor</a>[0] = selectColorLabel1-&gt;backgroundColor();
00546       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o9">selectColor</a>[1] = selectColorLabel2-&gt;backgroundColor();
00547       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o9">selectColor</a>[2] = selectColorLabel3-&gt;backgroundColor();
00548       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o9">selectColor</a>[3] = selectColorLabel4-&gt;backgroundColor();
00549 
00550       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o0">printCmd</a>    = printCmdEdit-&gt;text();
00551       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o1">browseCmd</a>   = browseCmdEdit-&gt;text();
00552       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o2">cursorBlink</a> = cursorBlink-&gt;isChecked();
00553       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o6">fgWallpaper</a> = fgWallpaper-&gt;text();
00554       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o5">bgWallpaper</a> = bgWallpaper-&gt;text();
00555       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o7">fgColor</a>     = fgColorLabel-&gt;backgroundColor();
00556       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o8">bgColor</a>     = bgColorLabel-&gt;backgroundColor();
00557       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o3">bgUseColor</a>  = bgColorButton-&gt;isChecked();
00558       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o4">fgUseColor</a>  = fgColorButton-&gt;isChecked();
00559       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o10">enableMidiInput</a> = enableMidiInput-&gt;isChecked();
00560       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o11">playNotes</a>   = playNotes-&gt;isChecked();
00561       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o12">soundFont</a>   = soundFont-&gt;text();
00562       <span class="keywordflow">if</span> (<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o13">lPort</a> != jackLPort-&gt;currentText()
00563          || <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o14">rPort</a> != jackRPort-&gt;currentText()) {
00564             <span class="comment">// TODO: change ports</span>
00565             <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o13">lPort</a>       = jackLPort-&gt;currentText();
00566             <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o14">rPort</a>       = jackRPort-&gt;currentText();
00567             }
00568       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o15">stemDir1</a> = <a class="code" href="preferences_8cpp.html#a1">buttonId2stemDir</a>(buttonGroup1-&gt;selectedId());
00569       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o16">stemDir2</a> = <a class="code" href="preferences_8cpp.html#a1">buttonId2stemDir</a>(buttonGroup2-&gt;selectedId());
00570       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o17">stemDir3</a> = <a class="code" href="preferences_8cpp.html#a1">buttonId2stemDir</a>(buttonGroup3-&gt;selectedId());
00571       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o18">stemDir4</a> = <a class="code" href="preferences_8cpp.html#a1">buttonId2stemDir</a>(buttonGroup4-&gt;selectedId());
00572       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o19">stemDir5</a> = <a class="code" href="preferences_8cpp.html#a1">buttonId2stemDir</a>(buttonGroup5-&gt;selectedId());
00573       emit <a class="code" href="classPreferenceDialog.html#l0">preferencesChanged</a>();
00574       <a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#a1">write</a>();
00575       <span class="keywordflow">if</span> (<a class="code" href="classPreferenceDialog.html#r0">sfChanged</a>) {
00576             <span class="keywordflow">if</span> (!<a class="code" href="seq_8cpp.html#a0">seq</a>-&gt;<a class="code" href="classSeq.html#a4">isRunning</a>()) {
00577                   <span class="comment">// try to start sequencer</span>
00578                   <a class="code" href="seq_8cpp.html#a0">seq</a>-&gt;<a class="code" href="classSeq.html#a3">init</a>();
00579                   }
00580             <span class="keywordflow">if</span> (<a class="code" href="seq_8cpp.html#a0">seq</a>-&gt;<a class="code" href="classSeq.html#a4">isRunning</a>()) {
00581                   <a class="code" href="classPreferenceDialog.html#r0">sfChanged</a> = <span class="keyword">false</span>;
00582                   <a class="code" href="seq_8cpp.html#a0">seq</a>-&gt;<a class="code" href="classSeq.html#a2">loadSoundFont</a>(<a class="code" href="preferences_8cpp.html#a0">preferences</a>.<a class="code" href="structPreferences.html#o12">soundFont</a>.latin1());
00583                   }
00584             }
00585       }
00586 
</div></pre><hr size="1"><address style="align: right;"><small>Generated on Mon Jun 27 22:28:29 2005 for MuseScore by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 ></a> 1.3.7 </small></address>
</body>
</html>
